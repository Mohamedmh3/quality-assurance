import type { UseCase } from '../types';

export const searchPageUseCases: UseCase[] = [
  {
    id: 'UC-SEARCH-001',
    title: 'Open Search Page',
    priority: 'Critical',
    userType: 'End User',
    description: 'When a customer opens the search page, the app displays search tabs, default sections, and allows them to search for restaurants, markets, or items.',
    preconditions: [
      'User is logged in or guest',
      'User has location permissions enabled',
      'User has a default address set',
    ],
    steps: [
      {
        step: 1,
        action: 'App initializes SearchViewModel and fetches search sections',
        expectedResult: 'Search tabs and sections loaded',
        uiState: 'Search page displays with tabs and default sections',
        flutterFile: 'search_viewmodel.dart:init()',
      },
      {
        step: 2,
        action: 'App displays search tabs (All, Restaurants, Markets, etc.)',
        expectedResult: 'Tabs shown in app bar',
        uiState: 'Tab bar visible with selected tab highlighted',
        flutterFile: 'search_section_widget.dart',
      },
      {
        step: 3,
        action: 'App loads default search sections for selected tab',
        expectedResult: 'Sections displayed (categories, suggestions, etc.)',
        uiState: 'Default search body shown with sections',
        flutterFile: 'default_search_body_widget.dart',
      },
    ],
    postconditions: [
      'Search page is displayed',
      'Search tabs are visible and functional',
      'Default sections are loaded',
      'Search input field is ready',
    ],
    successCriteria: [
      'Page loads without errors',
      'Tabs display correctly',
      'Sections load successfully',
      'Search input is accessible',
    ],
    relatedTestCases: ['TC-SEARCH-001', 'TC-SEARCH-002'],
  },
  {
    id: 'UC-SEARCH-002',
    title: 'Search for Restaurants',
    priority: 'Critical',
    userType: 'End User',
    description: 'Customer types in search query to find restaurants matching their search term.',
    preconditions: [
      'Search page is open',
      'User is on search screen',
    ],
    steps: [
      {
        step: 1,
        action: 'User types search query in search field',
        expectedResult: 'Search query stored in searchQuery',
        uiState: 'Text appears in search input',
        flutterFile: 'search_text_form_widget.dart',
      },
      {
        step: 2,
        action: 'App fetches search suggestions after user stops typing',
        expectedResult: 'Suggestions list populated',
        uiState: 'Suggestions dropdown appears',
        flutterFile: 'search_viewmodel.dart:fetchSearchSuggestList()',
      },
      {
        step: 3,
        action: 'User selects suggestion or presses search',
        expectedResult: 'Search executed with query',
        uiState: 'Search results screen displayed',
        flutterFile: 'search_viewmodel.dart:requestSearch()',
      },
      {
        step: 4,
        action: 'App fetches restaurants matching search query',
        expectedResult: 'Restaurant list returned',
        uiState: 'Restaurant cards displayed in results',
        flutterFile: 'search_service.dart:fetchSearch()',
      },
    ],
    postconditions: [
      'Search results displayed',
      'Restaurants matching query shown',
      'Filters can be applied',
      'Pagination available for more results',
    ],
    successCriteria: [
      'Search executes successfully',
      'Relevant restaurants displayed',
      'Results are paginated',
      'Filters work correctly',
    ],
    relatedTestCases: ['TC-SEARCH-003', 'TC-SEARCH-004', 'TC-SEARCH-005'],
  },
  {
    id: 'UC-SEARCH-003',
    title: 'Apply Search Filters',
    priority: 'High',
    userType: 'End User',
    description: 'Customer can apply filters to refine search results by price, rating, cuisine type, etc.',
    preconditions: [
      'Search results are displayed',
      'Filters are available',
    ],
    steps: [
      {
        step: 1,
        action: 'User taps on filter button or filter chip',
        expectedResult: 'Filter bottom sheet opens',
        uiState: 'Bottom sheet slides up with filter options',
        flutterFile: 'search_viewmodel.dart:changeSelectedFilter()',
      },
      {
        step: 2,
        action: 'User selects single or multiple filter options',
        expectedResult: 'Filters added to choosedFilter list',
        uiState: 'Selected filters highlighted',
        flutterFile: 'single_choice_bottom_sheet_widget.dart / multible_chioce_bottom_sheet_widget.dart',
      },
      {
        step: 3,
        action: 'User confirms filter selection',
        expectedResult: 'Search refreshed with filters applied',
        uiState: 'Filter chips shown in app bar',
        flutterFile: 'search_viewmodel.dart:requestSearch()',
      },
      {
        step: 4,
        action: 'App fetches filtered search results',
        expectedResult: 'Filtered restaurants returned',
        uiState: 'Results updated with filtered list',
        flutterFile: 'search_service.dart:fetchSearch()',
      },
    ],
    postconditions: [
      'Filters applied to search',
      'Filter chips visible in app bar',
      'Results updated',
      'User can clear filters',
    ],
    successCriteria: [
      'Filters apply correctly',
      'Results update immediately',
      'Filter state persists',
      'Clear filters works',
    ],
    relatedTestCases: ['TC-SEARCH-006', 'TC-SEARCH-007', 'TC-SEARCH-008'],
  },
  {
    id: 'UC-SEARCH-004',
    title: 'Browse Search Sections',
    priority: 'High',
    userType: 'End User',
    description: 'Customer can browse different search sections like categories, suggestions, and recommendations.',
    preconditions: [
      'Search page is open',
      'User is on default search screen',
    ],
    steps: [
      {
        step: 1,
        action: 'User switches between search tabs',
        expectedResult: 'Tab changed, sections reloaded',
        uiState: 'Selected tab highlighted, sections update',
        flutterFile: 'search_viewmodel.dart:changeSelectedTabIndex()',
      },
      {
        step: 2,
        action: 'App loads sections for selected tab',
        expectedResult: 'Sections fetched and displayed',
        uiState: 'Sections shown (categories, suggestions, etc.)',
        flutterFile: 'search_viewmodel.dart:searchSection()',
      },
      {
        step: 3,
        action: 'User taps on category or suggestion',
        expectedResult: 'Navigation to filtered restaurant list',
        uiState: 'Screen transitions to filtered view',
        flutterFile: 'default_search_body_widget.dart',
      },
    ],
    postconditions: [
      'Sections displayed correctly',
      'Categories are clickable',
      'Suggestions are clickable',
      'Navigation works',
    ],
    successCriteria: [
      'Sections load correctly',
      'Tabs switch smoothly',
      'Navigation works',
      'Content is relevant',
    ],
    relatedTestCases: ['TC-SEARCH-009', 'TC-SEARCH-010'],
  },
  {
    id: 'UC-SEARCH-005',
    title: 'Search for Items (Dishes)',
    priority: 'High',
    userType: 'End User',
    description: 'Customer can search for specific dishes or items across restaurants.',
    preconditions: [
      'Search page is open',
      'User wants to search for items',
    ],
    steps: [
      {
        step: 1,
        action: 'User types item name in search field',
        expectedResult: 'Search query stored',
        uiState: 'Text appears in search input',
        flutterFile: 'search_text_form_widget.dart',
      },
      {
        step: 2,
        action: 'App searches for items matching query',
        expectedResult: 'Items returned from search',
        uiState: 'Item results displayed',
        flutterFile: 'search_service.dart:searchItems()',
      },
      {
        step: 3,
        action: 'User taps on item result',
        expectedResult: 'Navigation to dish page',
        uiState: 'Dish detail screen opens',
        flutterFile: 'search_item_model.dart',
      },
    ],
    postconditions: [
      'Item search results displayed',
      'Items show restaurant information',
      'User can navigate to dish',
      'User can navigate to restaurant',
    ],
    successCriteria: [
      'Items search works',
      'Results are relevant',
      'Navigation works',
      'Item information is accurate',
    ],
    relatedTestCases: ['TC-SEARCH-011', 'TC-SEARCH-012'],
  },
  {
    id: 'UC-SEARCH-006',
    title: 'Recommend New Outlet',
    priority: 'Medium',
    userType: 'End User',
    description: 'Customer can recommend a new restaurant or market that is not in the app.',
    preconditions: [
      'User is logged in',
      'User wants to recommend outlet',
    ],
    steps: [
      {
        step: 1,
        action: 'User opens recommend outlet bottom sheet',
        expectedResult: 'Bottom sheet opens',
        uiState: 'Recommend form displayed',
        flutterFile: 'user_suggest_viewmodel.dart',
      },
      {
        step: 2,
        action: 'User selects outlet type (Restaurant or Market)',
        expectedResult: 'Outlet type stored',
        uiState: 'Toggle buttons update',
        flutterFile: 'user_suggest_view.dart',
      },
      {
        step: 3,
        action: 'User selects categories for outlet',
        expectedResult: 'Categories selected',
        uiState: 'Category chips highlighted',
        flutterFile: 'user_suggest_viewmodel.dart',
      },
      {
        step: 4,
        action: 'User fills outlet name, address, and city',
        expectedResult: 'Form data validated',
        uiState: 'Form fields populated',
        flutterFile: 'user_suggest_viewmodel.dart:userRecommend()',
      },
      {
        step: 5,
        action: 'User submits recommendation',
        expectedResult: 'Recommendation sent to server',
        uiState: 'Success message shown',
        flutterFile: 'search_service.dart:recommendOutlet()',
      },
    ],
    postconditions: [
      'Recommendation submitted',
      'Success message displayed',
      'Form cleared',
      'Bottom sheet closed',
    ],
    successCriteria: [
      'Form validation works',
      'Submission succeeds',
      'User feedback provided',
      'Data saved correctly',
    ],
    relatedTestCases: ['TC-SEARCH-013', 'TC-SEARCH-014'],
  },
  {
    id: 'UC-SEARCH-007',
    title: 'View Categories',
    priority: 'High',
    userType: 'End User',
    description: 'Customer can browse and select categories to filter restaurants.',
    preconditions: [
      'Search page is open',
      'Categories section is available',
    ],
    steps: [
      {
        step: 1,
        action: 'User navigates to categories section',
        expectedResult: 'Categories list displayed',
        uiState: 'Category cards shown',
        flutterFile: 'categories_view.dart',
      },
      {
        step: 2,
        action: 'App fetches categories list',
        expectedResult: 'Categories loaded',
        uiState: 'Categories displayed in grid or list',
        flutterFile: 'category_service.dart:fetchCategories()',
      },
      {
        step: 3,
        action: 'User taps on a category',
        expectedResult: 'Navigation to filtered restaurant list',
        uiState: 'Restaurant list filtered by category',
        flutterFile: 'categories_view_model.dart:changeSelectedCategory()',
      },
    ],
    postconditions: [
      'Categories displayed',
      'Category selection works',
      'Filtered results shown',
      'User can navigate back',
    ],
    successCriteria: [
      'Categories load correctly',
      'Selection works',
      'Filtering works',
      'Navigation works',
    ],
    relatedTestCases: ['TC-SEARCH-015', 'TC-SEARCH-016'],
  },
  {
    id: 'UC-SEARCH-008',
    title: 'Refresh Search Results',
    priority: 'Medium',
    userType: 'End User',
    description: 'Customer can pull to refresh search results or refresh when address changes.',
    preconditions: [
      'Search results are displayed',
      'User wants to refresh',
    ],
    steps: [
      {
        step: 1,
        action: 'User pulls down on search results list',
        expectedResult: 'Refresh triggered',
        uiState: 'Loading indicator shown',
        flutterFile: 'search_list_result_widget.dart',
      },
      {
        step: 2,
        action: 'App clears current results and fetches fresh data',
        expectedResult: 'New results loaded',
        uiState: 'Results updated',
        flutterFile: 'search_viewmodel.dart:forceSearchRefresh()',
      },
      {
        step: 3,
        action: 'App refreshes when address changes',
        expectedResult: 'Search refreshed for new location',
        uiState: 'Results updated for new address',
        flutterFile: 'search_viewmodel.dart:forceSearchRefresh()',
      },
    ],
    postconditions: [
      'Results refreshed',
      'New data displayed',
      'Pagination reset',
      'Filters maintained',
    ],
    successCriteria: [
      'Refresh works correctly',
      'New results loaded',
      'State maintained',
      'Loading states handled',
    ],
    relatedTestCases: ['TC-SEARCH-017', 'TC-SEARCH-018'],
  },
];

