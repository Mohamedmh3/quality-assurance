import { EdgeCase } from '@/lib/types';

export const knowUsEdgeCases: EdgeCase[] = [
  {
    id: 'EC-KNOW-US-001',
    title: 'Welcome Screen Fails to Load',
    category: 'UI',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Welcome screen widget fails to render or assets fail to load',
    expectedBehavior: 'App should handle missing assets gracefully, show placeholder or error message',
    uiHandling: {
      errorMessage: 'Welcome screen might not appear or assets might be missing',
      recoveryOptions: [
        'Show placeholder for missing images',
        'Handle asset loading errors',
        'Fallback to default UI',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_welcome_widget.dart'],
      validationRules: ['Handle asset loading errors'],
    },
    relatedTestCases: ['TC-KNOW-US-001'],
  },
  {
    id: 'EC-KNOW-US-002',
    title: 'Questions API Request Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to fetch questions fails',
    expectedBehavior: 'Error should be caught, user should see error message, retry option should be available',
    uiHandling: {
      errorMessage: 'Error message appears or loading state persists',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle network errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:74-88'],
      validationRules: ['Handle API errors gracefully'],
    },
    relatedTestCases: ['TC-KNOW-US-002'],
  },
  {
    id: 'EC-KNOW-US-003',
    title: 'Empty Questions List Returned',
    category: 'Data',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API returns empty questions list',
    expectedBehavior: 'App should handle empty list, show appropriate message, or redirect to welcome screen',
    uiHandling: {
      errorMessage: 'Empty state message or redirect to welcome screen',
      recoveryOptions: [
        'Show empty state message',
        'Redirect to welcome screen',
        'Handle empty list gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:79-83'],
      validationRules: ['Check if questionModel is empty'],
    },
    relatedTestCases: ['TC-KNOW-US-002'],
  },
  {
    id: 'EC-KNOW-US-004',
    title: 'Single Choice Answer Not Persisting',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Selected answer is lost or not stored correctly',
    expectedBehavior: 'Answer should persist until question is changed or survey is submitted',
    uiHandling: {
      errorMessage: 'Answer might disappear or not be saved',
      recoveryOptions: [
        'Ensure answer is stored in userAnswer list',
        'Verify UI reflects stored answer',
        'Maintain answer state correctly',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:111-162'],
      validationRules: ['Maintain answer state correctly'],
    },
    relatedTestCases: ['TC-KNOW-US-003'],
  },
  {
    id: 'EC-KNOW-US-005',
    title: 'Multiple Choice Answers Not Persisting',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Multiple selected answers are lost or not stored correctly',
    expectedBehavior: 'All selected answers should persist',
    uiHandling: {
      errorMessage: 'Some answers might disappear',
      recoveryOptions: [
        'Ensure all answers are stored in userAnswer list',
        'Verify UI reflects all selections',
        'Maintain multiple answer state correctly',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:130-149'],
      validationRules: ['Maintain multiple answer state correctly'],
    },
    relatedTestCases: ['TC-KNOW-US-004'],
  },
  {
    id: 'EC-KNOW-US-006',
    title: 'Date Picker Value Not Stored',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Selected date is not stored or stored incorrectly',
    expectedBehavior: 'Date should be stored in ISO8601 format',
    uiHandling: {
      errorMessage: 'Date might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify date is converted to ISO8601 string',
        'Ensure date is stored in userAnswer',
        'Verify date picker value is captured',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:270-295'],
      validationRules: ['Store date as ISO8601 string'],
    },
    relatedTestCases: ['TC-KNOW-US-005'],
  },
  {
    id: 'EC-KNOW-US-007',
    title: 'Note Text Not Saved',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Note text is not saved or associated with question',
    expectedBehavior: 'Note should be saved as user types and associated with question',
    uiHandling: {
      errorMessage: 'Note might not be saved or associated with wrong question',
      recoveryOptions: [
        'Verify note is saved on text change',
        'Ensure note is associated with correct question',
        'Update userAnswer with note',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:242-267'],
      validationRules: ['Save note on text change'],
    },
    relatedTestCases: ['TC-KNOW-US-006'],
  },
  {
    id: 'EC-KNOW-US-008',
    title: 'Navigation to Next Question Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'currentIndex update fails or next question is not displayed',
    expectedBehavior: 'Navigation should work correctly, next question should be displayed',
    uiHandling: {
      errorMessage: 'Navigation might not work or next question might not appear',
      recoveryOptions: [
        'Verify currentIndex is updated',
        'Ensure next question exists',
        'Handle index out of bounds',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_view.dart:255-256'],
      validationRules: ['Validate currentIndex before navigation'],
    },
    relatedTestCases: ['TC-KNOW-US-007'],
  },
  {
    id: 'EC-KNOW-US-009',
    title: 'Back Navigation Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Back navigation does not work or previous question is not displayed',
    expectedBehavior: 'Back navigation should work correctly, previous question should be displayed with saved answers',
    uiHandling: {
      errorMessage: 'Back button might not work or previous question might not appear',
      recoveryOptions: [
        'Verify currentIndex is decremented',
        'Ensure previous question exists',
        'Handle first question back navigation',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:102-108'],
      validationRules: ['Handle back navigation correctly'],
    },
    relatedTestCases: ['TC-KNOW-US-008'],
  },
  {
    id: 'EC-KNOW-US-010',
    title: 'Skip Question Not Recorded',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Skipped question is not recorded or marked incorrectly',
    expectedBehavior: 'Skipped question should be marked with answer ID 0',
    uiHandling: {
      errorMessage: 'Skip might not be recorded or question might appear again',
      recoveryOptions: [
        'Ensure answer with ID 0 is added',
        'Verify skip is recorded in userAnswer',
        'Increment currentIndex after skip',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:235-239'],
      validationRules: ['Mark skipped questions with answer ID 0'],
    },
    relatedTestCases: ['TC-KNOW-US-009'],
  },
  {
    id: 'EC-KNOW-US-011',
    title: 'Survey Submission Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to submit answers fails',
    expectedBehavior: 'Error should be caught, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Error message appears or submission hangs',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Keep answers preserved',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:188-198'],
      validationRules: ['Handle submission errors gracefully'],
    },
    relatedTestCases: ['TC-KNOW-US-010', 'TC-KNOW-US-013'],
  },
  {
    id: 'EC-KNOW-US-012',
    title: 'Survey Submission Times Out',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Survey submission request times out',
    expectedBehavior: 'Timeout should be handled, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Timeout error appears or request hangs',
      recoveryOptions: [
        'Handle timeout',
        'Show timeout message',
        'Allow retry',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:188-198'],
      validationRules: ['Handle timeout scenarios'],
    },
    relatedTestCases: ['TC-KNOW-US-010', 'TC-KNOW-US-013'],
  },
  {
    id: 'EC-KNOW-US-013',
    title: 'Progress Indicator Shows Incorrect Progress',
    category: 'UI',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Progress calculation is incorrect or progress bar does not update',
    expectedBehavior: 'Progress should be calculated as currentIndex / questionModel.length',
    uiHandling: {
      errorMessage: 'Progress might show incorrect value or not update',
      recoveryOptions: [
        'Verify progress calculation',
        'Ensure progress updates on navigation',
        'Handle edge cases (0 questions, last question)',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_view.dart:108-119'],
      validationRules: ['Calculate progress correctly'],
    },
    relatedTestCases: ['TC-KNOW-US-011'],
  },
  {
    id: 'EC-KNOW-US-014',
    title: 'Next Button Enabled When Question Not Answered',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Next button is enabled even when question is not answered',
    expectedBehavior: 'Next button should only be enabled when isTheQuestionIsAnswerd returns true',
    uiHandling: {
      errorMessage: 'Next button might be enabled incorrectly',
      recoveryOptions: [
        'Validate isTheQuestionIsAnswerd computed property',
        'Check all answer types (choice, date, note)',
        'Ensure validation is correct',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:200-221'],
      validationRules: ['Validate question is answered before enabling Next'],
    },
    relatedTestCases: ['TC-KNOW-US-012'],
  },
  {
    id: 'EC-KNOW-US-015',
    title: 'Answer List Becomes Corrupted',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'userAnswer list becomes corrupted or contains invalid data',
    expectedBehavior: 'Answer list should be validated before submission',
    uiHandling: {
      errorMessage: 'Submission might fail or send invalid data',
      recoveryOptions: [
        'Validate answer list before submission',
        'Clear corrupted answers',
        'Reset answer list if needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart:188-198'],
      validationRules: ['Validate answer list before submission'],
    },
    relatedTestCases: ['TC-KNOW-US-010'],
  },
  {
    id: 'EC-KNOW-US-016',
    title: 'Current Index Out of Bounds',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'currentIndex exceeds questionModel length or becomes negative',
    expectedBehavior: 'Index should be validated before accessing questionModel',
    uiHandling: {
      errorMessage: 'App might crash or show incorrect question',
      recoveryOptions: [
        'Validate currentIndex before accessing questionModel',
        'Handle index out of bounds',
        'Reset index if invalid',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_viewmodel.dart'],
      validationRules: ['Validate currentIndex before accessing array'],
    },
    relatedTestCases: ['TC-KNOW-US-007', 'TC-KNOW-US-008'],
  },
  {
    id: 'EC-KNOW-US-017',
    title: 'Question Model Becomes Null',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'questionModel becomes null during survey',
    expectedBehavior: 'App should handle null questionModel gracefully',
    uiHandling: {
      errorMessage: 'App might crash or show blank screen',
      recoveryOptions: [
        'Check if questionModel is null before accessing',
        'Show error message',
        'Redirect to welcome screen',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_view.dart'],
      validationRules: ['Check if questionModel is null'],
    },
    relatedTestCases: ['TC-KNOW-US-002'],
  },
  {
    id: 'EC-KNOW-US-018',
    title: 'Navigation After Submission Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Navigation after successful submission fails',
    expectedBehavior: 'User should be navigated to home or cart after submission',
    uiHandling: {
      errorMessage: 'Navigation might not occur or wrong screen is shown',
      recoveryOptions: [
        'Verify navigation logic',
        'Handle navigation errors',
        'Ensure context is available',
      ],
    },
    implementationNotes: {
      flutterFiles: ['know_us_view.dart:207-252'],
      validationRules: ['Handle navigation after submission'],
    },
    relatedTestCases: ['TC-KNOW-US-010'],
  },
];

