import type { EdgeCase } from '../types';

export const addressEdgeCases: EdgeCase[] = [
  {
    id: 'EC-ADDRESS-001',
    title: 'Location Permissions Denied',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Critical',
    triggerCondition: 'User denies location permissions when app asks',
    expectedBehavior: 'App shows error message. User cannot get current location. Map may show default location.',
    uiHandling: {
      errorMessage: 'Location permission denied message shown',
      recoveryOptions: [
        'User can go to phone settings and enable location permissions',
        'User can manually move map to select location',
        'User can use search to find location',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:620-656'],
      validationRules: ['Location permission check fails'],
      apiErrorCodes: ['Permission denied error'],
    },
    relatedTestCases: ['TC-ADDRESS-021'],
  },
  {
    id: 'EC-ADDRESS-002',
    title: 'Location Services Disabled',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'User has location services turned off on their phone',
    expectedBehavior: 'App shows error message. User cannot get current location automatically.',
    uiHandling: {
      errorMessage: 'Location services are disabled message',
      recoveryOptions: [
        'User can enable location services in phone settings',
        'User can manually move map to select location',
        'User can use search feature',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:625-631'],
      validationRules: ['Location services check fails'],
    },
    relatedTestCases: ['TC-ADDRESS-022'],
  },
  {
    id: 'EC-ADDRESS-003',
    title: 'Polygons API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'fetchPolygons request fails (network error, timeout, or server error)',
    expectedBehavior: 'App shows error message. Delivery areas may not display. User can still select location but may not know if it is in delivery area.',
    uiHandling: {
      errorMessage: 'Error message from exception shown',
      recoveryOptions: [
        'User can retry by going back and opening map again',
        'User can check internet connection',
        'User can still select location without seeing delivery areas',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:372-413', 'map_service.dart:20-37'],
      validationRules: ['Error caught in try-catch, message shown'],
      apiErrorCodes: ['Network errors, 500, timeout'],
    },
    relatedTestCases: ['TC-ADDRESS-023'],
  },
  {
    id: 'EC-ADDRESS-004',
    title: 'Address Title Too Long',
    category: 'Validation',
    likelihood: 'High',
    impact: 'Medium',
    triggerCondition: 'User types address title longer than 20 characters',
    expectedBehavior: 'App shows error message when user tries to save. Form validation fails.',
    uiHandling: {
      errorMessage: 'Invalid title message shown',
      recoveryOptions: [
        'User can shorten title to 20 characters or less',
        'User can use shorter name',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:155-161', 'validators.dart:51-53'],
      validationRules: ['Title must be not empty and length <= 20'],
    },
    relatedTestCases: ['TC-ADDRESS-024'],
  },
  {
    id: 'EC-ADDRESS-005',
    title: 'Address Title Empty',
    category: 'Validation',
    likelihood: 'High',
    impact: 'High',
    triggerCondition: 'User tries to save address without typing title',
    expectedBehavior: 'App shows error message. Form cannot be saved.',
    uiHandling: {
      errorMessage: 'Invalid title message shown',
      recoveryOptions: [
        'User must type an address title',
        'User can use any name like "Home" or "Work"',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:155-161', 'validators.dart:51-53'],
      validationRules: ['Title must not be empty'],
    },
    relatedTestCases: ['TC-ADDRESS-025'],
  },
  {
    id: 'EC-ADDRESS-006',
    title: 'Area Field Empty',
    category: 'Validation',
    likelihood: 'High',
    impact: 'High',
    triggerCondition: 'User tries to save address without typing area name',
    expectedBehavior: 'App shows error message. Form cannot be saved.',
    uiHandling: {
      errorMessage: 'Invalid area message shown',
      recoveryOptions: [
        'User must type area name',
        'User can type neighborhood or district name',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:179-185', 'validators.dart:55-57'],
      validationRules: ['Area must not be empty and length <= 20'],
    },
    relatedTestCases: ['TC-ADDRESS-026'],
  },
  {
    id: 'EC-ADDRESS-007',
    title: 'Street Field Empty',
    category: 'Validation',
    likelihood: 'High',
    impact: 'High',
    triggerCondition: 'User tries to save address without typing street name',
    expectedBehavior: 'App shows error message. Form cannot be saved.',
    uiHandling: {
      errorMessage: 'Invalid street message shown',
      recoveryOptions: [
        'User must type street name',
        'User can type street or road name',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:203-209', 'validators.dart:59-61'],
      validationRules: ['Street must not be empty and length <= 30'],
    },
    relatedTestCases: ['TC-ADDRESS-027'],
  },
  {
    id: 'EC-ADDRESS-008',
    title: 'Address Details Empty',
    category: 'Validation',
    likelihood: 'High',
    impact: 'High',
    triggerCondition: 'User tries to save address without typing details',
    expectedBehavior: 'App shows error message. Form cannot be saved.',
    uiHandling: {
      errorMessage: 'Invalid details message shown',
      recoveryOptions: [
        'User must type address details',
        'User can describe building, floor, or landmarks',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:254-260', 'validators.dart:75-77'],
      validationRules: ['Details must not be empty and length <= 150'],
    },
    relatedTestCases: ['TC-ADDRESS-028'],
  },
  {
    id: 'EC-ADDRESS-009',
    title: 'Phone Number Invalid Format',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'User types phone number that does not match required format (must start with 0 and have 10 digits)',
    expectedBehavior: 'App shows error message when user tries to save. Form validation fails.',
    uiHandling: {
      errorMessage: 'Invalid phone number message shown',
      recoveryOptions: [
        'User can fix phone number format',
        'User can leave phone field empty (optional)',
        'User can type correct format: starts with 0, 10 digits total',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:286-295', 'validators.dart:15-19'],
      validationRules: ['Phone must match regex pattern and be 10 digits'],
    },
    relatedTestCases: ['TC-ADDRESS-029'],
  },
  {
    id: 'EC-ADDRESS-010',
    title: 'Save Address API Fails',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Critical',
    triggerCondition: 'newAddress request fails (network error, timeout, or server error)',
    expectedBehavior: 'App shows error message. Address is not saved. User can retry.',
    uiHandling: {
      errorMessage: 'Error message from exception shown',
      recoveryOptions: [
        'User can check internet connection',
        'User can retry saving address',
        'User can go back and try again',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:304-337', 'home_service.dart:59-72'],
      validationRules: ['Error caught in try-catch, message shown'],
      apiErrorCodes: ['Network errors, 500, timeout'],
    },
    relatedTestCases: ['TC-ADDRESS-030'],
  },
  {
    id: 'EC-ADDRESS-011',
    title: 'Location Outside Delivery Area',
    category: 'Validation',
    likelihood: 'High',
    impact: 'Medium',
    triggerCondition: 'User selects location that is outside all delivery area polygons',
    expectedBehavior: 'Pin marker turns red. Message shows "Sorry, out of delivery area". Button shows "Notify" option.',
    uiHandling: {
      errorMessage: 'Out of delivery area message shown',
      recoveryOptions: [
        'User can select different location',
        'User can tap notify to request delivery for this area',
        'User can use current location button',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:579-617', 'add_address_view.dart:250-253'],
      validationRules: ['Location checked against polygon boundaries'],
    },
    relatedTestCases: ['TC-ADDRESS-031', 'TC-ADDRESS-017'],
  },
  {
    id: 'EC-ADDRESS-012',
    title: 'Location Too Far from Current Position',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User moves pin marker far from their actual GPS location, but still inside delivery polygon',
    expectedBehavior: 'Pin marker stays blue. Message shows "You are far from your location". Button shows "Back to location".',
    uiHandling: {
      errorMessage: 'Far from location message shown',
      recoveryOptions: [
        'User can tap "Back to location" button',
        'User can use floating location button',
        'User can continue if location is correct',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:579-617', 'add_address_view.dart:255-257'],
      validationRules: ['Distance calculated between pin and user location'],
    },
    relatedTestCases: ['TC-ADDRESS-032', 'TC-ADDRESS-019'],
  },
  {
    id: 'EC-ADDRESS-013',
    title: 'Map Zoomed Out Too Far',
    category: 'Validation',
    likelihood: 'High',
    impact: 'Medium',
    triggerCondition: 'User tries to confirm location when map zoom level is less than 16',
    expectedBehavior: 'Message shows "Please zoom more to get accurate location". Button shows "Zoom in more".',
    uiHandling: {
      errorMessage: 'Zoom in more message shown',
      recoveryOptions: [
        'User can pinch to zoom in on map',
        'User can tap zoom button multiple times',
        'User can use zoom controls',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:254-261', 'add_address_view.dart:258-259, 275-296'],
      validationRules: ['Zoom level must be >= 16'],
    },
    relatedTestCases: ['TC-ADDRESS-033', 'TC-ADDRESS-018'],
  },
  {
    id: 'EC-ADDRESS-014',
    title: 'Search Location API Fails',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'fetchSearchLocations request fails',
    expectedBehavior: 'Search results do not appear. No error message shown. User can still use map manually.',
    uiHandling: {
      errorMessage: 'No error message shown, search simply does not work',
      recoveryOptions: [
        'User can manually move map to select location',
        'User can use current location button',
        'User can check internet connection and retry',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:504-523', 'map_service.dart:62-86'],
      validationRules: ['Error caught silently, empty results returned'],
    },
    relatedTestCases: ['TC-ADDRESS-034'],
  },
  {
    id: 'EC-ADDRESS-015',
    title: 'Search Returns No Results',
    category: 'Data',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User searches for location that does not exist or cannot be found',
    expectedBehavior: 'Search results list is empty. User can try different search terms.',
    uiHandling: {
      errorMessage: 'No error message, just empty results list',
      recoveryOptions: [
        'User can try different search terms',
        'User can manually move map',
        'User can use current location',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:504-523'],
      validationRules: ['Empty list returned from search'],
    },
    relatedTestCases: ['TC-ADDRESS-035'],
  },
  {
    id: 'EC-ADDRESS-016',
    title: 'Address Auto-Fill Fails',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'fetchOsmLocationDetails request fails when trying to auto-fill address fields',
    expectedBehavior: 'Address fields do not auto-fill. No error shown. User can manually type address.',
    uiHandling: {
      errorMessage: 'No error message shown, fields simply do not auto-fill',
      recoveryOptions: [
        'User can manually type address information',
        'User can continue without auto-fill',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:443-455', 'map_service.dart:40-59'],
      validationRules: ['Error caught silently, null returned'],
    },
    relatedTestCases: ['TC-ADDRESS-036'],
  },
  {
    id: 'EC-ADDRESS-017',
    title: 'Notify Address API Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'voteForAddress request fails',
    expectedBehavior: 'App shows error message. Notification is not saved. User can retry.',
    uiHandling: {
      errorMessage: 'Error message from exception shown',
      recoveryOptions: [
        'User can check internet connection',
        'User can retry notification',
        'User can select different location',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:416-441', 'home_service.dart:105-115'],
      validationRules: ['Error caught in try-catch'],
    },
    relatedTestCases: ['TC-ADDRESS-037'],
  },
  {
    id: 'EC-ADDRESS-018',
    title: 'Guest User Tries to Save Address',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'User is not logged in and tries to save address',
    expectedBehavior: 'App may save location temporarily but user may need to log in. Behavior depends on implementation.',
    uiHandling: {
      errorMessage: 'May show login prompt or save location only',
      recoveryOptions: [
        'User can log in to save address',
        'User can continue as guest if allowed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['add_address_view.dart:298-310'],
      validationRules: ['User login status checked'],
    },
    relatedTestCases: ['TC-ADDRESS-038'],
  },
  {
    id: 'EC-ADDRESS-019',
    title: 'Area Field Too Long',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'User types area name longer than 20 characters',
    expectedBehavior: 'App shows error message when user tries to save. Form validation fails.',
    uiHandling: {
      errorMessage: 'Invalid area message shown',
      recoveryOptions: [
        'User can shorten area name to 20 characters or less',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:179-185', 'validators.dart:55-57'],
      validationRules: ['Area length must be <= 20'],
    },
    relatedTestCases: ['TC-ADDRESS-039'],
  },
  {
    id: 'EC-ADDRESS-020',
    title: 'Street Field Too Long',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'User types street name longer than 30 characters',
    expectedBehavior: 'App shows error message when user tries to save. Form validation fails.',
    uiHandling: {
      errorMessage: 'Invalid street message shown',
      recoveryOptions: [
        'User can shorten street name to 30 characters or less',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:203-209', 'validators.dart:59-61'],
      validationRules: ['Street length must be <= 30'],
    },
    relatedTestCases: ['TC-ADDRESS-040'],
  },
  {
    id: 'EC-ADDRESS-021',
    title: 'Address Details Too Long',
    category: 'Validation',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'User types address details longer than 150 characters',
    expectedBehavior: 'App prevents typing beyond 150 characters. Field shows character limit.',
    uiHandling: {
      errorMessage: 'Character limit reached, cannot type more',
      recoveryOptions: [
        'User can shorten details to 150 characters or less',
        'User can remove unnecessary information',
      ],
    },
    implementationNotes: {
      flutterFiles: ['new_address_details_view.dart:250', 'validators.dart:75-77'],
      validationRules: ['Details length must be <= 150'],
    },
    relatedTestCases: ['TC-ADDRESS-041'],
  },
  {
    id: 'EC-ADDRESS-022',
    title: 'Map Controller Not Ready',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'User tries to interact with map before map controller is initialized',
    expectedBehavior: 'App waits for map to load. User sees loading indicator.',
    uiHandling: {
      errorMessage: 'Loading indicator shown',
      recoveryOptions: [
        'User waits for map to load',
        'No action needed, app handles automatically',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:186, 233'],
      validationRules: ['Map controller future checked before use'],
    },
    relatedTestCases: ['TC-ADDRESS-042'],
  },
  {
    id: 'EC-ADDRESS-023',
    title: 'Rapid Map Movement',
    category: 'Concurrency',
    likelihood: 'High',
    impact: 'Low',
    triggerCondition: 'User rapidly drags map back and forth',
    expectedBehavior: 'App processes each movement. Address lookup may be debounced. Final position is used.',
    uiHandling: {
      errorMessage: 'No error, map responds smoothly',
      recoveryOptions: [
        'App handles rapid movements correctly',
        'No user action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['add_address_view.dart:113-120'],
      validationRules: ['Address lookup happens on camera idle'],
    },
    relatedTestCases: ['TC-ADDRESS-043'],
  },
  {
    id: 'EC-ADDRESS-024',
    title: 'Search While Typing',
    category: 'Concurrency',
    likelihood: 'High',
    impact: 'Low',
    triggerCondition: 'User types quickly in search box, triggering multiple searches',
    expectedBehavior: 'App waits for user to stop typing (debounce). Only final search is performed.',
    uiHandling: {
      errorMessage: 'No error, search happens after user stops typing',
      recoveryOptions: [
        'App handles debouncing automatically',
        'No user action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['map_viewmodel.dart:488-502'],
      validationRules: ['500ms debounce timer before search'],
    },
    relatedTestCases: ['TC-ADDRESS-044'],
  },
];

