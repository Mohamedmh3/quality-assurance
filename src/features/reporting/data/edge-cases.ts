import { EdgeCase } from '@/lib/types';

export const reportingEdgeCases: EdgeCase[] = [
  {
    id: 'EC-REPORTING-001',
    title: 'Issue Types API Request Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to fetch issue types fails',
    expectedBehavior: 'Error should be caught, user should see error message, retry option should be available',
    uiHandling: {
      errorMessage: 'Error message appears or loading state persists',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle network errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:24-41'],
      validationRules: ['Handle API errors gracefully'],
    },
    relatedTestCases: ['TC-REPORTING-009'],
  },
  {
    id: 'EC-REPORTING-002',
    title: 'Empty Issue Types List Returned',
    category: 'Data',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'API returns empty issue types list',
    expectedBehavior: 'App should handle empty list, show appropriate message or empty state',
    uiHandling: {
      errorMessage: 'Empty state message or no issue types available',
      recoveryOptions: [
        'Show empty state message',
        'Handle empty list gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:24-41'],
      validationRules: ['Check if issue types list is empty'],
    },
    relatedTestCases: ['TC-REPORTING-001', 'TC-REPORTING-009'],
  },
  {
    id: 'EC-REPORTING-003',
    title: 'Navigation Between Steps Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Step navigation does not work or next step is not displayed',
    expectedBehavior: 'Navigation should work correctly, next step should be displayed',
    uiHandling: {
      errorMessage: 'Navigation might not work or next step might not appear',
      recoveryOptions: [
        'Verify flowIndex is updated',
        'Ensure next step exists',
        'Handle index out of bounds',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:saveAndNext'],
      validationRules: ['Validate flowIndex before navigation'],
    },
    relatedTestCases: ['TC-REPORTING-002'],
  },
  {
    id: 'EC-REPORTING-004',
    title: 'Step Data Not Preserved',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Data entered in step is lost when navigating',
    expectedBehavior: 'Data should be preserved in drafts when navigating between steps',
    uiHandling: {
      errorMessage: 'Data might be lost when navigating',
      recoveryOptions: [
        'Ensure data is saved in flowDrafts',
        'Verify drafts are loaded when returning to step',
        'Maintain draft state correctly',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:saveAndNext'],
      validationRules: ['Save data in flowDrafts before navigation'],
    },
    relatedTestCases: ['TC-REPORTING-002'],
  },
  {
    id: 'EC-REPORTING-005',
    title: 'Date Selection Not Saved',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Selected date is not saved or saved incorrectly',
    expectedBehavior: 'Date should be saved in draft when selected',
    uiHandling: {
      errorMessage: 'Date might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify date is saved in draft',
        'Ensure date is included in payload',
        'Check date format',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_reason_form.dart'],
      validationRules: ['Save date in draft when selected'],
    },
    relatedTestCases: ['TC-REPORTING-003'],
  },
  {
    id: 'EC-REPORTING-006',
    title: 'Dish Search Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Dish search API request fails',
    expectedBehavior: 'Error should be caught, user should see error message or empty results',
    uiHandling: {
      errorMessage: 'Error message appears or search shows no results',
      recoveryOptions: [
        'Show error message',
        'Show empty results',
        'Handle search errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:123-150'],
      validationRules: ['Handle search API errors'],
    },
    relatedTestCases: ['TC-REPORTING-004'],
  },
  {
    id: 'EC-REPORTING-007',
    title: 'Dish Search Returns Empty Results',
    category: 'Data',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'Dish search returns no results',
    expectedBehavior: 'Empty state should be shown, user should be able to try different search',
    uiHandling: {
      errorMessage: 'Empty results message or no dishes found',
      recoveryOptions: [
        'Show empty state message',
        'Allow user to try different search',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:123-150'],
      validationRules: ['Handle empty search results'],
    },
    relatedTestCases: ['TC-REPORTING-004'],
  },
  {
    id: 'EC-REPORTING-008',
    title: 'Note Text Not Saved',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Note text is not saved or saved incorrectly',
    expectedBehavior: 'Note should be saved in draft as user types',
    uiHandling: {
      errorMessage: 'Note might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify note is saved in draft',
        'Ensure note is included in payload',
        'Check note is saved on text change',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_reason_form.dart'],
      validationRules: ['Save note in draft on text change'],
    },
    relatedTestCases: ['TC-REPORTING-005'],
  },
  {
    id: 'EC-REPORTING-009',
    title: 'App Name Not Saved',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'App name is not saved or saved incorrectly',
    expectedBehavior: 'App name should be saved in draft when entered',
    uiHandling: {
      errorMessage: 'App name might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify app name is saved in draft',
        'Ensure app name is included in payload',
        'Check app name is saved on text change',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_reason_form.dart'],
      validationRules: ['Save app name in draft when entered'],
    },
    relatedTestCases: ['TC-REPORTING-006'],
  },
  {
    id: 'EC-REPORTING-010',
    title: 'Back Navigation Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Back navigation does not work or previous step is not displayed',
    expectedBehavior: 'Back navigation should work correctly, previous step should be displayed with saved data',
    uiHandling: {
      errorMessage: 'Back button might not work or previous step might not appear',
      recoveryOptions: [
        'Verify flowIndex is decremented',
        'Ensure previous step exists',
        'Handle first step back navigation',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_issue_steps_view.dart:29-36'],
      validationRules: ['Handle back navigation correctly'],
    },
    relatedTestCases: ['TC-REPORTING-007'],
  },
  {
    id: 'EC-REPORTING-011',
    title: 'Report Submission Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to submit report fails',
    expectedBehavior: 'Error should be caught, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Error message appears or submission hangs',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Keep data preserved',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:93-110'],
      validationRules: ['Handle submission errors gracefully'],
    },
    relatedTestCases: ['TC-REPORTING-008', 'TC-REPORTING-012'],
  },
  {
    id: 'EC-REPORTING-012',
    title: 'Report Submission Times Out',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Report submission request times out',
    expectedBehavior: 'Timeout should be handled, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Timeout error appears or request hangs',
      recoveryOptions: [
        'Handle timeout',
        'Show timeout message',
        'Allow retry',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:93-110'],
      validationRules: ['Handle timeout scenarios'],
    },
    relatedTestCases: ['TC-REPORTING-008', 'TC-REPORTING-012'],
  },
  {
    id: 'EC-REPORTING-013',
    title: 'Progress Indicator Shows Incorrect Progress',
    category: 'UI',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Progress calculation is incorrect or progress header does not update',
    expectedBehavior: 'Progress should be calculated as completed/total and update correctly',
    uiHandling: {
      errorMessage: 'Progress might show incorrect value or not update',
      recoveryOptions: [
        'Verify progress calculation',
        'Ensure progress updates on navigation',
        'Handle edge cases (first step, last step)',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_progress_header.dart'],
      validationRules: ['Calculate progress correctly'],
    },
    relatedTestCases: ['TC-REPORTING-010'],
  },
  {
    id: 'EC-REPORTING-014',
    title: 'More Than 3 Reasons Selected',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'User somehow selects more than 3 reasons',
    expectedBehavior: 'Maximum 3 reasons should be enforced, fourth selection should be prevented',
    uiHandling: {
      errorMessage: 'Fourth reason might be selected incorrectly',
      recoveryOptions: [
        'Enforce maximum 3 selections',
        'Prevent fourth selection',
        'Validate selection count',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:70-71'],
      validationRules: ['Enforce maximum 3 selections'],
    },
    relatedTestCases: ['TC-REPORTING-011'],
  },
  {
    id: 'EC-REPORTING-015',
    title: 'Flow Index Out of Bounds',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'flowIndex exceeds flowReasons length or becomes negative',
    expectedBehavior: 'Index should be validated before accessing flowReasons',
    uiHandling: {
      errorMessage: 'App might crash or show incorrect step',
      recoveryOptions: [
        'Validate flowIndex before accessing array',
        'Handle index out of bounds',
        'Reset index if invalid',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart'],
      validationRules: ['Validate flowIndex before accessing array'],
    },
    relatedTestCases: ['TC-REPORTING-002'],
  },
  {
    id: 'EC-REPORTING-016',
    title: 'Required Fields Not Validated',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Submit button is enabled even when required fields are not filled',
    expectedBehavior: 'Submit button should only be enabled when all required fields are filled',
    uiHandling: {
      errorMessage: 'Submit might be enabled incorrectly',
      recoveryOptions: [
        'Validate all required fields',
        'Check field requirements based on reason metadata',
        'Ensure validation is correct',
      ],
    },
    implementationNotes: {
      flutterFiles: ['report_reason_form.dart'],
      validationRules: ['Validate required fields before enabling submit'],
    },
    relatedTestCases: ['TC-REPORTING-008'],
  },
  {
    id: 'EC-REPORTING-017',
    title: 'Draft Data Becomes Corrupted',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'flowDrafts becomes corrupted or contains invalid data',
    expectedBehavior: 'Draft data should be validated before submission',
    uiHandling: {
      errorMessage: 'Submission might fail or send invalid data',
      recoveryOptions: [
        'Validate draft data before submission',
        'Clear corrupted drafts',
        'Reset drafts if needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:93-110'],
      validationRules: ['Validate draft data before submission'],
    },
    relatedTestCases: ['TC-REPORTING-008'],
  },
  {
    id: 'EC-REPORTING-018',
    title: 'Dish Search Debounce Not Working',
    category: 'Performance',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Dish search makes too many API requests',
    expectedBehavior: 'Search should be debounced with 300ms delay',
    uiHandling: {
      errorMessage: 'Too many API requests might be made',
      recoveryOptions: [
        'Ensure debounce timer is set',
        'Cancel previous timer on new input',
        'Verify 300ms delay',
      ],
    },
    implementationNotes: {
      flutterFiles: ['reporting_viewmodel.dart:115-121'],
      validationRules: ['Debounce search with 300ms delay'],
    },
    relatedTestCases: ['TC-REPORTING-004'],
  },
];


