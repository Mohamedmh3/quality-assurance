import { EdgeCase } from '@/lib/types';

export const editProfileEdgeCases: EdgeCase[] = [
  {
    id: 'EC-EDIT-PROFILE-001',
    title: 'Initial Data API Request Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to fetch initial data (cities, genders, user info, loyalty info) fails',
    expectedBehavior: 'Error should be caught, user should see error message with retry option',
    uiHandling: {
      errorMessage: 'Error message appears or loading state persists',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle network errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:37-83'],
      validationRules: ['Handle API errors gracefully'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-011'],
  },
  {
    id: 'EC-EDIT-PROFILE-002',
    title: 'Partial Initial Data Load Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'One or more initial data requests fail (cities, genders, user info, or loyalty info)',
    expectedBehavior: 'Error should be caught, user should see error message, retry should reload all data',
    uiHandling: {
      errorMessage: 'Error message appears for failed requests',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle partial failures',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:40-45'],
      validationRules: ['Handle partial failures in parallel requests'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-011'],
  },
  {
    id: 'EC-EDIT-PROFILE-003',
    title: 'Name Field Not Saving',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Name field value is not saved or saved incorrectly',
    expectedBehavior: 'Name should be saved correctly when form is submitted',
    uiHandling: {
      errorMessage: 'Name might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify name controller value is included in update',
        'Ensure name is trimmed before saving',
        'Check name validation',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:107'],
      validationRules: ['Save name controller value trimmed'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-002'],
  },
  {
    id: 'EC-EDIT-PROFILE-004',
    title: 'Email Field Not Saving',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Email field value is not saved or saved incorrectly',
    expectedBehavior: 'Email should be saved correctly when form is submitted',
    uiHandling: {
      errorMessage: 'Email might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify email controller value is included in update',
        'Ensure email is trimmed before saving',
        'Check email validation',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:108'],
      validationRules: ['Save email controller value trimmed'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-003'],
  },
  {
    id: 'EC-EDIT-PROFILE-005',
    title: 'Date of Birth Not Saving',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Date of birth is not saved or saved incorrectly',
    expectedBehavior: 'Date should be saved correctly when form is submitted',
    uiHandling: {
      errorMessage: 'Date might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify date controller value is parsed correctly',
        'Ensure date is converted to DateTime',
        'Check date format',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:104', 'edit_profile_viewmodel.dart:111'],
      validationRules: ['Parse date controller value to DateTime'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-004'],
  },
  {
    id: 'EC-EDIT-PROFILE-006',
    title: 'Gender Selection Not Saving',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Selected gender is not saved or saved incorrectly',
    expectedBehavior: 'Gender should be saved correctly when form is submitted',
    uiHandling: {
      errorMessage: 'Gender might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify selectedGender is included in update',
        'Ensure gender ID is saved',
        'Check gender selection state',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:110'],
      validationRules: ['Save selectedGender ID'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-005'],
  },
  {
    id: 'EC-EDIT-PROFILE-007',
    title: 'City Selection Not Saving',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Selected city is not saved or saved incorrectly',
    expectedBehavior: 'City should be saved correctly when form is submitted',
    uiHandling: {
      errorMessage: 'City might not be saved or saved incorrectly',
      recoveryOptions: [
        'Verify selectedCity is included in update',
        'Ensure city ID is saved',
        'Check city selection state',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:109'],
      validationRules: ['Save selectedCity ID'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-006'],
  },
  {
    id: 'EC-EDIT-PROFILE-008',
    title: 'Loyalty Info Not Displayed',
    category: 'Data',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Loyalty info is null or not loaded',
    expectedBehavior: 'App should handle null loyalty info gracefully, show empty state or hide widget',
    uiHandling: {
      errorMessage: 'Loyalty widget might not appear or show incorrect data',
      recoveryOptions: [
        'Check if loyaltyInfo is null',
        'Show empty state',
        'Hide widget if null',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_screen.dart:120-126'],
      validationRules: ['Handle null loyalty info'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-007'],
  },
  {
    id: 'EC-EDIT-PROFILE-009',
    title: 'Profile Update Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request to update user info fails',
    expectedBehavior: 'Error should be caught, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Error message appears or update hangs',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Keep form data preserved',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:100-135'],
      validationRules: ['Handle update errors gracefully'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-008', 'TC-EDIT-PROFILE-013'],
  },
  {
    id: 'EC-EDIT-PROFILE-010',
    title: 'Profile Update Times Out',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Profile update request times out',
    expectedBehavior: 'Timeout should be handled, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Timeout error appears or request hangs',
      recoveryOptions: [
        'Handle timeout',
        'Show timeout message',
        'Allow retry',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:100-135'],
      validationRules: ['Handle timeout scenarios'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-008', 'TC-EDIT-PROFILE-013'],
  },
  {
    id: 'EC-EDIT-PROFILE-011',
    title: 'Logout Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Logout API request fails',
    expectedBehavior: 'Error should be caught, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Error message appears or logout hangs',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle logout errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:137-158'],
      validationRules: ['Handle logout errors gracefully'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-009'],
  },
  {
    id: 'EC-EDIT-PROFILE-012',
    title: 'Delete Account Fails',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Delete account API request fails',
    expectedBehavior: 'Error should be caught, loading state cleared, user can retry',
    uiHandling: {
      errorMessage: 'Error message appears or deletion hangs',
      recoveryOptions: [
        'Show error message',
        'Allow retry',
        'Handle deletion errors gracefully',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:160-176'],
      validationRules: ['Handle deletion errors gracefully'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-010'],
  },
  {
    id: 'EC-EDIT-PROFILE-013',
    title: 'Form Validation Bypassed',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Form is submitted with invalid data',
    expectedBehavior: 'Form validation should prevent submission of invalid data',
    uiHandling: {
      errorMessage: 'Invalid data might be submitted',
      recoveryOptions: [
        'Validate form before submission',
        'Check all field validators',
        'Prevent submission if invalid',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_form.dart'],
      validationRules: ['Validate form before calling updateUserInfo'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-012'],
  },
  {
    id: 'EC-EDIT-PROFILE-014',
    title: 'Date Controller Format Mismatch',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Date controller value cannot be parsed to DateTime',
    expectedBehavior: 'Date should be parsed correctly or handled gracefully if invalid',
    uiHandling: {
      errorMessage: 'Date might not be parsed or saved incorrectly',
      recoveryOptions: [
        'Handle DateTime parsing errors',
        'Validate date format',
        'Set date to null if invalid',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:104'],
      validationRules: ['Handle DateTime parsing errors'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-004'],
  },
  {
    id: 'EC-EDIT-PROFILE-015',
    title: 'User Info Becomes Null',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'userInfo becomes null during update',
    expectedBehavior: 'App should handle null userInfo gracefully, prevent update if null',
    uiHandling: {
      errorMessage: 'Update might fail or crash',
      recoveryOptions: [
        'Check if userInfo is null before update',
        'Return early if null',
        'Show error message',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:101'],
      validationRules: ['Check if userInfo is null before update'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-008'],
  },
  {
    id: 'EC-EDIT-PROFILE-016',
    title: 'Navigation After Save Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Navigation after successful save fails',
    expectedBehavior: 'User should be navigated back or to splash screen after save',
    uiHandling: {
      errorMessage: 'Navigation might not occur or wrong screen is shown',
      recoveryOptions: [
        'Verify navigation logic',
        'Handle navigation errors',
        'Ensure context is available',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:124-132'],
      validationRules: ['Handle navigation after save'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-008'],
  },
  {
    id: 'EC-EDIT-PROFILE-017',
    title: 'Viewmodel Reset After Logout Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Viewmodel reset after logout fails',
    expectedBehavior: 'Viewmodels should be reset correctly after logout',
    uiHandling: {
      errorMessage: 'Viewmodels might not be reset correctly',
      recoveryOptions: [
        'Verify viewmodel reset logic',
        'Handle reset errors',
        'Ensure clean state',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:148-151'],
      validationRules: ['Reset viewmodels after logout'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-009'],
  },
  {
    id: 'EC-EDIT-PROFILE-018',
    title: 'Baskets Not Deleted After Account Deletion',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Baskets are not deleted after account deletion',
    expectedBehavior: 'All baskets should be deleted when account is deleted',
    uiHandling: {
      errorMessage: 'Baskets might remain after account deletion',
      recoveryOptions: [
        'Verify basket deletion logic',
        'Ensure deleteAllBaskets is called',
        'Check basket deletion success',
      ],
    },
    implementationNotes: {
      flutterFiles: ['edit_profile_viewmodel.dart:169'],
      validationRules: ['Delete all baskets after account deletion'],
    },
    relatedTestCases: ['TC-EDIT-PROFILE-010'],
  },
];

