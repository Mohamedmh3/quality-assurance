import type { EdgeCase } from '../types';

export const restaurantListEdgeCases: EdgeCase[] = [
  {
    id: 'EC-REST-LIST-001',
    title: 'Restaurant List API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Critical',
    triggerCondition: 'fetchRestaurants API call fails (network error, timeout, or server error)',
    expectedBehavior: 'App displays error message. Empty state may show. User can retry.',
    uiHandling: {
      errorMessage: 'Error message from exception or "An error occurred"',
      recoveryOptions: [
        'User can pull to refresh',
        'User can navigate back and try again',
        'User checks internet connection',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_service.dart:60-95', 'restaurant_viewmodel.dart:264-302'],
      validationRules: ['Error caught in try-catch, message shown via showMessage'],
      apiErrorCodes: ['Network errors, 500, timeout'],
    },
    relatedTestCases: ['TC-REST-LIST-023', 'TC-REST-LIST-024'],
  },
  {
    id: 'EC-REST-LIST-002',
    title: 'Categories API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'fetchCategories API call fails',
    expectedBehavior: 'Categories section hidden or shows error. Restaurant list still loads.',
    uiHandling: {
      errorMessage: 'Error message shown, categories section may be hidden',
      recoveryOptions: [
        'User can still browse restaurants',
        'User can retry by navigating back',
        'User checks internet connection',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:325-343'],
      validationRules: ['Error handled, categories list may be empty'],
    },
    relatedTestCases: ['TC-REST-LIST-025'],
  },
  {
    id: 'EC-REST-LIST-003',
    title: 'Filters API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'fetchFilters API call fails',
    expectedBehavior: 'Filters section hidden or shows error. Restaurant list still loads.',
    uiHandling: {
      errorMessage: 'Error message shown, filters section may be hidden',
      recoveryOptions: [
        'User can still browse restaurants',
        'User can retry by navigating back',
        'User checks internet connection',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:346-362'],
      validationRules: ['Error handled, filters list may be empty'],
    },
    relatedTestCases: ['TC-REST-LIST-026'],
  },
  {
    id: 'EC-REST-LIST-004',
    title: 'Banners API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'fetchBanners API call fails',
    expectedBehavior: 'Banners section hidden. Restaurant list continues to load normally.',
    uiHandling: {
      errorMessage: 'No error message shown, banners simply not displayed',
      recoveryOptions: [
        'User can still browse restaurants',
        'Banners are optional, no action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:414-419', 'restaurant_view.dart:164-183'],
      validationRules: ['Banners conditionally rendered, empty list handled'],
    },
    relatedTestCases: ['TC-REST-LIST-027'],
  },
  {
    id: 'EC-REST-LIST-005',
    title: 'ETA API Fails to Load',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'fetchRestaurantsWithReta API call fails',
    expectedBehavior: 'Restaurants display without ETA. Restaurant list still functional.',
    uiHandling: {
      errorMessage: 'No error message shown, restaurants display without delivery times',
      recoveryOptions: [
        'User can still browse restaurants',
        'ETA is optional, no action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:285-301', 'restaurant_service.dart:25-57'],
      validationRules: ['Error caught, restaurants displayed without ETA'],
    },
    relatedTestCases: ['TC-REST-LIST-028'],
  },
  {
    id: 'EC-REST-LIST-006',
    title: 'No Restaurants Available',
    category: 'Data',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'Restaurant list API returns empty array',
    expectedBehavior: 'App displays empty state with sad mascot and "no_results" message.',
    uiHandling: {
      errorMessage: 'Empty state widget displayed',
      recoveryOptions: [
        'User can clear filters',
        'User can change delivery type',
        'User can navigate back',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:282-297'],
      validationRules: ['Empty list checked, empty state widget shown'],
    },
    relatedTestCases: ['TC-REST-LIST-022'],
  },
  {
    id: 'EC-REST-LIST-007',
    title: 'No Categories Available',
    category: 'Data',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Categories API returns empty list',
    expectedBehavior: 'Categories section hidden. Restaurant list still displays.',
    uiHandling: {
      errorMessage: 'No error message, categories section simply not displayed',
      recoveryOptions: [
        'User can still browse restaurants',
        'User can use filters instead',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:432-460'],
      validationRules: ['Categories conditionally rendered based on list length'],
    },
    relatedTestCases: ['TC-REST-LIST-029'],
  },
  {
    id: 'EC-REST-LIST-008',
    title: 'No Filters Available',
    category: 'Data',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Filters API returns empty list',
    expectedBehavior: 'Filters section hidden. Restaurant list still displays.',
    uiHandling: {
      errorMessage: 'No error message, filters section simply not displayed',
      recoveryOptions: [
        'User can still browse restaurants',
        'User can use categories instead',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:488-606'],
      validationRules: ['Filters conditionally rendered based on list length'],
    },
    relatedTestCases: ['TC-REST-LIST-030'],
  },
  {
    id: 'EC-REST-LIST-009',
    title: 'Guest User Exceeds Restaurant Limit',
    category: 'Validation',
    likelihood: 'High',
    impact: 'Medium',
    triggerCondition: 'Guest user views restaurant list with more restaurants than allowedOutletsCountForGuest',
    expectedBehavior: 'App limits displayed restaurants to allowed count. Shows login prompt.',
    uiHandling: {
      errorMessage: 'LoginToSeeMoreWidget displayed at end of list',
      recoveryOptions: [
        'User can tap login prompt to sign in',
        'User can continue browsing limited restaurants',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:256-282', 'restaurant_view.dart:263-275'],
      validationRules: ['Restaurant list truncated, showLoginToSeeMore set to true'],
    },
    relatedTestCases: ['TC-REST-LIST-014', 'TC-REST-LIST-015'],
  },
  {
    id: 'EC-REST-LIST-010',
    title: 'Pagination Reaches Last Page',
    category: 'State',
    likelihood: 'High',
    impact: 'Low',
    triggerCondition: 'getMorePages returns empty list',
    expectedBehavior: 'Pagination stops. No more restaurants loaded. Pull-up disabled.',
    uiHandling: {
      errorMessage: 'No error message, pagination simply stops',
      recoveryOptions: [
        'User has seen all available restaurants',
        'No action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:364-401'],
      validationRules: ['Empty list check, enablePullUp set to true if empty'],
    },
    relatedTestCases: ['TC-REST-LIST-031'],
  },
  {
    id: 'EC-REST-LIST-011',
    title: 'Filter Combination Results in Empty List',
    category: 'Data',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'Selected filters and categories result in no matching restaurants',
    expectedBehavior: 'App displays empty state. User can clear filters to see restaurants.',
    uiHandling: {
      errorMessage: 'Empty state widget displayed',
      recoveryOptions: [
        'User can tap Clear button',
        'User can deselect filters',
        'User can change delivery type',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:282-297'],
      validationRules: ['Empty list checked after filtering'],
    },
    relatedTestCases: ['TC-REST-LIST-022', 'TC-REST-LIST-032'],
  },
  {
    id: 'EC-REST-LIST-012',
    title: 'Location Data Missing',
    category: 'Data',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'User location (lat/lng) is null or invalid',
    expectedBehavior: 'App may show error or use default location. Restaurant list may not load correctly.',
    uiHandling: {
      errorMessage: 'Error message or default location used',
      recoveryOptions: [
        'User enables location permissions',
        'User sets default address',
        'User contacts support',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_service.dart:76-77'],
      validationRules: ['Location required for restaurant list API'],
    },
    relatedTestCases: ['TC-REST-LIST-033'],
  },
  {
    id: 'EC-REST-LIST-013',
    title: 'Default Address Missing',
    category: 'Data',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'User has no default address set',
    expectedBehavior: 'App may show error or use location coordinates. Restaurant list may not load correctly.',
    uiHandling: {
      errorMessage: 'Error message or location used instead',
      recoveryOptions: [
        'User sets default address',
        'User enables location permissions',
        'User contacts support',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_service.dart:78-79'],
      validationRules: ['Address ID required for restaurant list API'],
    },
    relatedTestCases: ['TC-REST-LIST-034'],
  },
  {
    id: 'EC-REST-LIST-014',
    title: 'Rapid Filter Changes',
    category: 'Concurrency',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User rapidly taps multiple filters in quick succession',
    expectedBehavior: 'App processes each filter change. Restaurant list updates for final state.',
    uiHandling: {
      errorMessage: 'No error message, filters process normally',
      recoveryOptions: [
        'App handles rapid changes correctly',
        'Final filter state is correct',
        'No user action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:127-249'],
      validationRules: ['Each filter change triggers new API call'],
    },
    relatedTestCases: ['TC-REST-LIST-035'],
  },
  {
    id: 'EC-REST-LIST-015',
    title: 'Scheduled Order Picker - No Available Times',
    category: 'Data',
    likelihood: 'Medium',
    impact: 'Medium',
    triggerCondition: 'Restaurant has no available scheduled order times',
    expectedBehavior: 'App displays empty state with "There are no available times" message.',
    uiHandling: {
      errorMessage: 'TimesEmptyWidget displayed',
      recoveryOptions: [
        'User can cancel and try different restaurant',
        'User can try different day',
        'User can contact restaurant',
      ],
    },
    implementationNotes: {
      flutterFiles: ['scheduled_picker_page.dart:152, 331-351'],
      validationRules: ['Empty times list checked, empty widget shown'],
    },
    relatedTestCases: ['TC-REST-LIST-036'],
  },
  {
    id: 'EC-REST-LIST-016',
    title: 'Scheduled Order Picker - Day Not Online',
    category: 'State',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'Selected day has online=false (restaurant closed)',
    expectedBehavior: 'Day is disabled/grayed out. Times list shows empty state.',
    uiHandling: {
      errorMessage: 'Day disabled, times empty widget shown',
      recoveryOptions: [
        'User selects different day',
        'User cancels scheduled order',
      ],
    },
    implementationNotes: {
      flutterFiles: ['scheduled_picker_page.dart:99-108, 226-227'],
      validationRules: ['Day online status checked before allowing selection'],
    },
    relatedTestCases: ['TC-REST-LIST-037'],
  },
  {
    id: 'EC-REST-LIST-017',
    title: 'Category Image Fails to Load',
    category: 'UI',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'Category image URL is invalid or fails to load',
    expectedBehavior: 'App displays default image placeholder. Category still functional.',
    uiHandling: {
      errorMessage: 'No error message, default image shown',
      recoveryOptions: [
        'Category still works',
        'User can still filter',
        'No action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:812-825'],
      validationRules: ['Image null check, default image shown'],
    },
    relatedTestCases: ['TC-REST-LIST-038'],
  },
  {
    id: 'EC-REST-LIST-018',
    title: 'Filter Bottom Sheet Dismissal',
    category: 'State',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User opens filter bottom sheet but dismisses without selecting',
    expectedBehavior: 'Bottom sheet closes. Filter state unchanged. No error.',
    uiHandling: {
      errorMessage: 'No error message, bottom sheet closes normally',
      recoveryOptions: [
        'User can open filter again',
        'Filter state preserved',
        'No action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_view.dart:615-708'],
      validationRules: ['Bottom sheet dismissible, state unchanged if cancelled'],
    },
    relatedTestCases: ['TC-REST-LIST-039'],
  },
  {
    id: 'EC-REST-LIST-019',
    title: 'Pagination During Filter Change',
    category: 'Concurrency',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User changes filter while pagination is loading',
    expectedBehavior: 'App resets pagination and fetches new filtered list. Previous pagination cancelled.',
    uiHandling: {
      errorMessage: 'No error message, pagination resets correctly',
      recoveryOptions: [
        'App handles reset automatically',
        'No user action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['restaurant_viewmodel.dart:133, 190, 246'],
      validationRules: ['resetPagination called before filter change'],
    },
    relatedTestCases: ['TC-REST-LIST-040'],
  },
  {
    id: 'EC-REST-LIST-020',
    title: 'Scheduled Order Time Selection - Today vs Future',
    category: 'State',
    likelihood: 'High',
    impact: 'Medium',
    triggerCondition: 'User selects time slot that is today vs future date',
    expectedBehavior: 'App formats time differently for today (time only) vs future (date + time).',
    uiHandling: {
      errorMessage: 'No error message, time formatted correctly',
      recoveryOptions: [
        'Time saves correctly',
        'Formatting is automatic',
        'No user action needed',
      ],
    },
    implementationNotes: {
      flutterFiles: ['scheduled_picker_page.dart:404-428'],
      validationRules: ['Date comparison to determine if today'],
    },
    relatedTestCases: ['TC-REST-LIST-041'],
  },
];



