import { EdgeCase } from '@/lib/types';

export const liveChatEdgeCases: EdgeCase[] = [
  {
    id: 'EC-LIVE-CHAT-001',
    title: 'Live Chat Button Not Visible',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Live chat is disabled in settings or button is not configured for current screen',
    expectedBehavior: 'Button should not appear when feature is disabled. No error should occur.',
    uiHandling: {
      errorMessage: 'N/A - Button is simply not displayed',
      recoveryOptions: ['Enable live chat in settings', 'Check screen configuration'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-012'],
  },
  {
    id: 'EC-LIVE-CHAT-002',
    title: 'Chat URL Fetch Fails',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'API request to fetch chat URL fails due to network error, timeout, or server error',
    expectedBehavior: 'Error state should be displayed. User should see error message. Retry option should be available.',
    uiHandling: {
      errorMessage: 'Something went wrong (localized)',
      recoveryOptions: ['Retry by navigating back and reopening chat', 'Check network connection'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart', 'live_chat_viewmodel.dart'],
      apiErrorCodes: ['Network error', 'Timeout', 'Server error'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-007', 'TC-LIVE-CHAT-008'],
  },
  {
    id: 'EC-LIVE-CHAT-003',
    title: 'Chat URL is Null or Empty',
    category: 'Data',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API returns null or empty chat URL',
    expectedBehavior: 'Error widget should be displayed showing "Something went wrong" message with sad mascot icon.',
    uiHandling: {
      errorMessage: 'Something went wrong (localized)',
      recoveryOptions: ['Retry by reopening chat', 'Contact support via other means'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
      validationRules: ['Check if URL is null before displaying web view'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-008'],
  },
  {
    id: 'EC-LIVE-CHAT-004',
    title: 'Unread Count is Negative or Invalid',
    category: 'Data',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'API returns negative or invalid unread count value',
    expectedBehavior: 'Badge should not display if count is 0 or negative. Badge should handle invalid values gracefully.',
    uiHandling: {
      errorMessage: 'N/A - Handled gracefully',
      recoveryOptions: ['Badge hides automatically', 'Count resets to 0'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart'],
      validationRules: ['Check if messagesCount > 0 before showing badge'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-003'],
  },
  {
    id: 'EC-LIVE-CHAT-005',
    title: 'Web View Fails to Load Chat URL',
    category: 'Network',
    likelihood: 'Medium',
    impact: 'High',
    triggerCondition: 'Web view cannot load chat URL due to invalid URL, SSL error, or network issue',
    expectedBehavior: 'Web view should handle loading errors. Error state may be shown. User should be able to retry.',
    uiHandling: {
      errorMessage: 'Unable to load chat. Please try again.',
      recoveryOptions: ['Retry loading', 'Check network connection', 'Navigate back and reopen'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
      validationRules: ['Handle web view loading errors', 'Validate URL before loading'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-005'],
  },
  {
    id: 'EC-LIVE-CHAT-006',
    title: 'Chat Interface is Not Responsive',
    category: 'Performance',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Chat web view becomes unresponsive or freezes',
    expectedBehavior: 'App should remain responsive. User should be able to navigate back. Web view should recover or show error.',
    uiHandling: {
      errorMessage: 'Chat is not responding. Please try again.',
      recoveryOptions: ['Navigate back and reopen chat', 'Restart app'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-005'],
  },
  {
    id: 'EC-LIVE-CHAT-007',
    title: 'Loading State Never Completes',
    category: 'Network',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'API request hangs indefinitely or never completes',
    expectedBehavior: 'Loading should timeout after reasonable time. Error state should be shown. User should be able to retry.',
    uiHandling: {
      errorMessage: 'Chat is taking too long to load. Please try again.',
      recoveryOptions: ['Retry by navigating back and reopening', 'Check network connection'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_viewmodel.dart'],
      validationRules: ['Implement timeout for API requests', 'Handle hanging requests'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-007'],
  },
  {
    id: 'EC-LIVE-CHAT-008',
    title: 'Multiple Rapid Taps on Chat Button',
    category: 'Concurrency',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'User rapidly taps live chat button multiple times',
    expectedBehavior: 'Only one navigation should occur. Multiple chat screens should not open. Button should be debounced.',
    uiHandling: {
      errorMessage: 'N/A - Handled automatically',
      recoveryOptions: ['Only first tap is processed'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart'],
      validationRules: ['Debounce button taps', 'Prevent multiple navigations'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-002'],
  },
  {
    id: 'EC-LIVE-CHAT-009',
    title: 'Web View Cache Not Cleared',
    category: 'State',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Cache clearing fails or is not executed properly',
    expectedBehavior: 'Chat should still load. Old cached data may appear. User should be able to refresh or clear cache manually.',
    uiHandling: {
      errorMessage: 'N/A - Chat may show cached data',
      recoveryOptions: ['Refresh chat', 'Clear app cache', 'Restart app'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
      validationRules: ['Ensure cache clearing executes', 'Handle cache clearing errors'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-011'],
  },
  {
    id: 'EC-LIVE-CHAT-010',
    title: 'BillId Parameter is Invalid',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Invalid or non-existent billId is passed to chat',
    expectedBehavior: 'Chat should still open without order context. Error should not occur. Chat should function normally.',
    uiHandling: {
      errorMessage: 'N/A - Chat opens without order context',
      recoveryOptions: ['Chat opens normally', 'User can mention order manually'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_viewmodel.dart'],
      validationRules: ['Validate billId before using', 'Handle invalid billId gracefully'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-004'],
  },
  {
    id: 'EC-LIVE-CHAT-011',
    title: 'Animation Performance Issues',
    category: 'Performance',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Button animation causes performance issues or battery drain',
    expectedBehavior: 'Animation should be optimized. Performance should not degrade. Animation can be paused if needed.',
    uiHandling: {
      errorMessage: 'N/A - Performance optimization',
      recoveryOptions: ['Animation is optimized', 'Animation can be disabled if needed'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-009'],
  },
  {
    id: 'EC-LIVE-CHAT-012',
    title: 'Unread Count Updates While Chat is Open',
    category: 'State',
    likelihood: 'Medium',
    impact: 'Low',
    triggerCondition: 'New messages arrive while user is viewing chat screen',
    expectedBehavior: 'Unread count should update reactively. Badge on button should reflect current count. Count should decrease when messages are read.',
    uiHandling: {
      errorMessage: 'N/A - Handled automatically',
      recoveryOptions: ['Count updates automatically via Observer'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart', 'live_chat_viewmodel.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-003'],
  },
  {
    id: 'EC-LIVE-CHAT-013',
    title: 'Screen Orientation Change During Chat',
    category: 'UI',
    likelihood: 'High',
    impact: 'Low',
    triggerCondition: 'User rotates device while chat screen is open',
    expectedBehavior: 'Chat screen should adapt to new orientation. Web view should resize correctly. Chat interface should remain functional.',
    uiHandling: {
      errorMessage: 'N/A - Handled automatically',
      recoveryOptions: ['Screen adapts automatically'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-005'],
  },
  {
    id: 'EC-LIVE-CHAT-014',
    title: 'App Goes to Background During Chat',
    category: 'State',
    likelihood: 'High',
    impact: 'Low',
    triggerCondition: 'User switches to another app while chat is open',
    expectedBehavior: 'Chat session should remain active. When user returns, chat should still be open. Messages should sync.',
    uiHandling: {
      errorMessage: 'N/A - Handled automatically',
      recoveryOptions: ['Chat resumes when app returns to foreground'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-005'],
  },
  {
    id: 'EC-LIVE-CHAT-015',
    title: 'Tutorial Interferes with Chat Button',
    category: 'UI',
    likelihood: 'Low',
    impact: 'Low',
    triggerCondition: 'Tutorial overlay blocks or interferes with chat button interaction',
    expectedBehavior: 'Tutorial should not prevent button taps. Tutorial should dismiss properly. Button should be accessible.',
    uiHandling: {
      errorMessage: 'N/A - Tutorial handling',
      recoveryOptions: ['Dismiss tutorial', 'Tutorial does not block interaction'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_button_widget.dart'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-010'],
  },
  {
    id: 'EC-LIVE-CHAT-016',
    title: 'SSL Certificate Validation Error',
    category: 'Network',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'Chat URL has SSL certificate issues or validation fails',
    expectedBehavior: 'Web view should proceed with chat loading. SSL validation should be handled. Chat should load despite certificate issues.',
    uiHandling: {
      errorMessage: 'N/A - SSL issues are handled automatically',
      recoveryOptions: ['Chat loads despite SSL issues', 'Certificate validation is bypassed'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart'],
      validationRules: ['Handle SSL certificate validation', 'Proceed with chat loading'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-002'],
  },
  {
    id: 'EC-LIVE-CHAT-017',
    title: 'Chat URL Contains Invalid Characters',
    category: 'Validation',
    likelihood: 'Low',
    impact: 'Medium',
    triggerCondition: 'API returns chat URL with invalid characters or malformed URL',
    expectedBehavior: 'URL should be validated before loading. Error should be shown if URL is invalid. User should be able to retry.',
    uiHandling: {
      errorMessage: 'Something went wrong (localized)',
      recoveryOptions: ['Retry by reopening chat', 'Contact support'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_view.dart', 'live_chat_viewmodel.dart'],
      validationRules: ['Validate URL format', 'Handle malformed URLs'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-008'],
  },
  {
    id: 'EC-LIVE-CHAT-018',
    title: 'ViewModel Initialization Fails',
    category: 'State',
    likelihood: 'Low',
    impact: 'High',
    triggerCondition: 'LiveChatViewModel fails to initialize or services fail to create',
    expectedBehavior: 'Error should be caught and handled. Error state should be shown. App should not crash.',
    uiHandling: {
      errorMessage: 'Unable to initialize chat. Please try again.',
      recoveryOptions: ['Retry by reopening chat', 'Restart app'],
    },
    implementationNotes: {
      flutterFiles: ['live_chat_viewmodel.dart'],
      validationRules: ['Handle initialization errors', 'Catch exceptions'],
    },
    relatedTestCases: ['TC-LIVE-CHAT-002'],
  },
];


