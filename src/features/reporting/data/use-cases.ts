import { UseCase } from '@/lib/types';

export const reportingUseCases: UseCase[] = [
  {
    id: 'UC-REPORTING-001',
    title: 'Display Issue Type Selection Screen',
    priority: 'Critical',
    userType: 'End User',
    description: 'User sees list of available issue types for a restaurant and can select up to 3 issue reasons',
    preconditions: ['User is on restaurant page', 'Reporting feature is accessible'],
    steps: [
      {
        step: 1,
        action: 'Navigate to report issue screen',
        expectedResult: 'Issue type selection screen is displayed',
        uiState: 'Screen shows list of issue types with their reasons, loading state while fetching',
        flutterFile: 'report_issue_selection_screen.dart:17-94',
      },
      {
        step: 2,
        action: 'View available issue types',
        expectedResult: 'Issue types are displayed with their reasons',
        uiState: 'Each issue type shows as a card/widget with its name and reasons',
        flutterFile: 'report_issues_section.dart',
      },
      {
        step: 3,
        action: 'Select issue reasons',
        expectedResult: 'Up to 3 reasons can be selected',
        uiState: 'Selected reasons are highlighted, selection order is maintained',
        flutterFile: 'reporting_viewmodel.dart:65-80',
      },
    ],
    postconditions: ['Issue types are displayed', 'User can select reasons'],
    successCriteria: ['Screen loads', 'Issue types are displayed', 'Selection works'],
    relatedTestCases: ['TC-REPORTING-001'],
  },
  {
    id: 'UC-REPORTING-002',
    title: 'Navigate Through Issue Reason Steps',
    priority: 'High',
    userType: 'End User',
    description: 'User navigates through multi-step form for each selected issue reason, providing required details',
    preconditions: ['User has selected issue reasons', 'At least one reason is selected'],
    steps: [
      {
        step: 1,
        action: 'Start reporting flow',
        expectedResult: 'First reason step is displayed',
        uiState: 'Progress header shows step 1 of total, current reason name, next reason name',
        flutterFile: 'report_issue_steps_view.dart:38-100',
      },
      {
        step: 2,
        action: 'Fill required fields for reason',
        expectedResult: 'Fields are filled based on reason requirements',
        uiState: 'Form shows fields based on reason metadata (date, dish search, note, app name)',
        flutterFile: 'report_reason_form.dart',
      },
      {
        step: 3,
        action: 'Navigate to next step',
        expectedResult: 'Next reason step is displayed',
        uiState: 'Progress updates, next reason form appears',
        flutterFile: 'reporting_viewmodel.dart:saveAndNext',
      },
      {
        step: 4,
        action: 'Complete all steps',
        expectedResult: 'All reasons are completed',
        uiState: 'Progress reaches 100%, submit button appears on last step',
        flutterFile: 'report_issue_steps_view.dart:60-61',
      },
    ],
    postconditions: ['All steps are completed', 'Data is saved in drafts'],
    successCriteria: ['Navigation works', 'Progress updates', 'Data is saved'],
    relatedTestCases: ['TC-REPORTING-002'],
  },
  {
    id: 'UC-REPORTING-003',
    title: 'Select Date for Issue Reason',
    priority: 'High',
    userType: 'End User',
    description: 'User selects a date when reason requires date selection',
    preconditions: ['User is on reason step', 'Reason has withDate = true'],
    steps: [
      {
        step: 1,
        action: 'View date field',
        expectedResult: 'Date picker field is displayed',
        uiState: 'Date picker widget appears in form',
        flutterFile: 'report_special_fields.dart.dart',
      },
      {
        step: 2,
        action: 'Select a date',
        expectedResult: 'Date is selected and stored',
        uiState: 'Selected date is displayed in field',
        flutterFile: 'report_reason_form.dart',
      },
    ],
    postconditions: ['Date is selected', 'Date is stored in draft'],
    successCriteria: ['Date picker appears', 'Date can be selected', 'Date is saved'],
    relatedTestCases: ['TC-REPORTING-003'],
  },
  {
    id: 'UC-REPORTING-004',
    title: 'Search and Select Dish',
    priority: 'High',
    userType: 'End User',
    description: 'User searches for and selects a dish when reason requires dish selection',
    preconditions: ['User is on reason step', 'Reason has withDishSearch = true'],
    steps: [
      {
        step: 1,
        action: 'View dish search field',
        expectedResult: 'Dish search field is displayed',
        uiState: 'Search input field appears with dish picker button',
        flutterFile: 'report_dish_selection_field.dart',
      },
      {
        step: 2,
        action: 'Open dish picker',
        expectedResult: 'Dish search bottom sheet opens',
        uiState: 'Bottom sheet slides up with search input and dish list',
        flutterFile: 'report_dish_search_and_picker_sheet.dart',
      },
      {
        step: 3,
        action: 'Search for dish',
        expectedResult: 'Search results are displayed',
        uiState: 'Dishes matching search query appear in list, debounced search (300ms)',
        flutterFile: 'reporting_viewmodel.dart:115-121',
      },
      {
        step: 4,
        action: 'Select a dish',
        expectedResult: 'Dish is selected',
        uiState: 'Selected dish appears in form field, bottom sheet closes',
        flutterFile: 'report_dish_search_and_picker_sheet.dart',
      },
    ],
    postconditions: ['Dish is selected', 'Dish is stored in draft'],
    successCriteria: ['Search works', 'Dish can be selected', 'Dish is saved'],
    relatedTestCases: ['TC-REPORTING-004'],
  },
  {
    id: 'UC-REPORTING-005',
    title: 'Enter Note for Issue Reason',
    priority: 'High',
    userType: 'End User',
    description: 'User enters additional notes when reason requires note input',
    preconditions: ['User is on reason step', 'Reason has withNote = true'],
    steps: [
      {
        step: 1,
        action: 'View note field',
        expectedResult: 'Note input field is displayed',
        uiState: 'Text input field appears in form',
        flutterFile: 'report_additional_info_field.dart',
      },
      {
        step: 2,
        action: 'Enter note text',
        expectedResult: 'Note is entered and stored',
        uiState: 'Text is entered in field, note is saved as user types',
        flutterFile: 'report_reason_form.dart',
      },
    ],
    postconditions: ['Note is entered', 'Note is stored in draft'],
    successCriteria: ['Note field appears', 'Note can be entered', 'Note is saved'],
    relatedTestCases: ['TC-REPORTING-005'],
  },
  {
    id: 'UC-REPORTING-006',
    title: 'Enter App Name for Issue Reason',
    priority: 'Medium',
    userType: 'End User',
    description: 'User enters app name when reason requires other app name',
    preconditions: ['User is on reason step', 'Reason has withAppsName = true'],
    steps: [
      {
        step: 1,
        action: 'View app name field',
        expectedResult: 'App name input field is displayed',
        uiState: 'Text input field appears in form',
        flutterFile: 'report_special_fields.dart.dart',
      },
      {
        step: 2,
        action: 'Enter app name',
        expectedResult: 'App name is entered and stored',
        uiState: 'Text is entered in field, app name is saved',
        flutterFile: 'report_reason_form.dart',
      },
    ],
    postconditions: ['App name is entered', 'App name is stored in draft'],
    successCriteria: ['App name field appears', 'App name can be entered', 'App name is saved'],
    relatedTestCases: ['TC-REPORTING-006'],
  },
  {
    id: 'UC-REPORTING-007',
    title: 'Navigate Back to Previous Step',
    priority: 'Medium',
    userType: 'End User',
    description: 'User navigates back to previous reason step to review or modify answers',
    preconditions: ['User is not on first step', 'Previous steps exist'],
    steps: [
      {
        step: 1,
        action: 'Tap back button',
        expectedResult: 'Previous step is displayed',
        uiState: 'Current step disappears, previous step appears with saved data',
        flutterFile: 'report_issue_steps_view.dart:29-36',
      },
      {
        step: 2,
        action: 'View previous step data',
        expectedResult: 'Previous step shows saved draft data',
        uiState: 'Form fields are pre-filled with previously entered data',
        flutterFile: 'report_issue_steps_view.dart:83',
      },
      {
        step: 3,
        action: 'Tap back on first step',
        expectedResult: 'Returns to issue type selection screen',
        uiState: 'Step screen closes, issue type selection screen appears',
        flutterFile: 'report_issue_steps_view.dart:35',
      },
    ],
    postconditions: ['Previous step is displayed', 'Data is preserved'],
    successCriteria: ['Back navigation works', 'Data is preserved', 'First step back works'],
    relatedTestCases: ['TC-REPORTING-007'],
  },
  {
    id: 'UC-REPORTING-008',
    title: 'Submit Report',
    priority: 'Critical',
    userType: 'End User',
    description: 'User submits completed report with all selected issue reasons and their details',
    preconditions: ['User has completed all reason steps', 'All required fields are filled'],
    steps: [
      {
        step: 1,
        action: 'Complete last step',
        expectedResult: 'Submit button is enabled',
        uiState: 'Submit button appears on last step, becomes enabled when form is valid',
        flutterFile: 'report_submit_button.dart',
      },
      {
        step: 2,
        action: 'Tap Submit button',
        expectedResult: 'Report is submitted',
        uiState: 'Loading dialog appears, submit button shows loading state',
        flutterFile: 'report_issue_selection_screen.dart:41-47',
      },
      {
        step: 3,
        action: 'Wait for submission',
        expectedResult: 'Submission completes',
        uiState: 'Loading dialog disappears, success snackbar appears',
        flutterFile: 'report_issue_selection_screen.dart:64-88',
      },
      {
        step: 4,
        action: 'Navigate after success',
        expectedResult: 'User is navigated back',
        uiState: 'Screen closes, user returns to previous screen, success message is shown',
        flutterFile: 'report_issue_selection_screen.dart:72-87',
      },
    ],
    postconditions: ['Report is submitted', 'User is navigated back'],
    successCriteria: ['Submission works', 'Success message appears', 'Navigation occurs'],
    relatedTestCases: ['TC-REPORTING-008'],
  },
  {
    id: 'UC-REPORTING-009',
    title: 'Fetch Issue Types from API',
    priority: 'Critical',
    userType: 'System',
    description: 'System fetches available issue types and reasons for a restaurant from API',
    preconditions: ['User navigates to report screen', 'Restaurant ID is available', 'Network connection available'],
    steps: [
      {
        step: 1,
        action: 'Screen initializes',
        expectedResult: 'API request is initiated',
        uiState: 'Loading state appears while fetching',
        flutterFile: 'reporting_viewmodel.dart:24-41',
      },
      {
        step: 2,
        action: 'Issue types are fetched',
        expectedResult: 'Issue types are loaded',
        uiState: 'Issue types with their reasons are displayed',
        flutterFile: 'reporting_service.dart:19-29',
      },
      {
        step: 3,
        action: 'Reason metadata is built',
        expectedResult: 'Metadata map is created',
        uiState: 'Metadata includes flags for date, dish search, note, app name for each reason',
        flutterFile: 'reporting_viewmodel.dart:43-62',
      },
    ],
    postconditions: ['Issue types are loaded', 'Metadata is ready'],
    successCriteria: ['API request works', 'Issue types are loaded', 'Metadata is built'],
    relatedTestCases: ['TC-REPORTING-009'],
  },
  {
    id: 'UC-REPORTING-010',
    title: 'View Progress Indicator',
    priority: 'Medium',
    userType: 'End User',
    description: 'Progress indicator shows current step and total steps during reporting flow',
    preconditions: ['User is in reporting flow', 'Steps are active'],
    steps: [
      {
        step: 1,
        action: 'View progress header',
        expectedResult: 'Progress header is displayed',
        uiState: 'Progress header shows "Step X of Y", current reason name, next reason name',
        flutterFile: 'report_progress_header.dart',
      },
      {
        step: 2,
        action: 'Navigate through steps',
        expectedResult: 'Progress updates',
        uiState: 'Progress header updates as user moves through steps',
        flutterFile: 'report_issue_steps_view.dart:54-58',
      },
    ],
    postconditions: ['Progress is visible', 'Progress updates correctly'],
    successCriteria: ['Progress header appears', 'Progress updates', 'Progress is accurate'],
    relatedTestCases: ['TC-REPORTING-010'],
  },
];

