import { TestCase } from '@/lib/types';

export const liveChatTestCases: TestCase[] = [
  {
    id: 'TC-LIVE-CHAT-001',
    title: 'Display Live Chat Button',
    whatYoureTesting: 'Verify that live chat floating action button appears and is visible on screens where it should be displayed',
    whyItMatters: 'Users need to easily access customer support. The chat button must be visible and accessible.',
    estimatedTime: '1 minute',
    type: 'Functional',
    priority: 'P0',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: ['EC-LIVE-CHAT-001'],
    testSteps: [
      {
        step: 1,
        instruction: 'Navigate to a screen with live chat button',
        detailedSteps: [
          '1. Open the app',
          '2. Navigate to profile screen or other screen with live chat enabled',
          '3. Look for floating action button',
        ],
        whatYouShouldSee: 'A floating action button appears at the bottom-right corner of the screen. The button is circular with a chat bubble icon (CupertinoIcons.chat_bubble_2_fill) in white color. The button has a subtle bounce animation that moves it up and down continuously.',
        expectedResult: 'Live chat button is visible',
      },
      {
        step: 2,
        instruction: 'Verify button animation',
        detailedSteps: [
          '1. Observe the button movement',
          '2. Check animation smoothness',
        ],
        whatYouShouldSee: 'The button animates with a bounce effect, moving vertically up and down. Animation repeats continuously with a 1-second duration. The movement is smooth and draws attention without being distracting.',
        expectedResult: 'Button animation works correctly',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'User is on a screen with live chat button',
    ],
    testData: 'N/A',
    automatable: true,
    status: 'Not Started',
    notes: 'Live chat button only appears if live chat is enabled in settings',
    successChecklist: [
      '✓ Live chat button is visible',
      '✓ Button has correct icon',
      '✓ Animation works smoothly',
      '✓ Button is positioned correctly',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-002',
    title: 'Open Live Chat Screen',
    whatYoureTesting: 'Verify that tapping live chat button navigates to chat screen and loads chat interface',
    whyItMatters: 'Users need to access chat support. Navigation must work correctly and chat must load.',
    estimatedTime: '2-3 minutes',
    type: 'Functional',
    priority: 'P0',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: ['EC-LIVE-CHAT-002', 'EC-LIVE-CHAT-003'],
    testSteps: [
      {
        step: 1,
        instruction: 'Tap live chat button',
        detailedSteps: [
          '1. Find the floating live chat button',
          '2. Tap on the button',
        ],
        whatYouShouldSee: 'When you tap the button, navigation occurs. The screen transitions to live chat screen. An app bar appears at the top with "Contact Us" title (localized).',
        expectedResult: 'Navigation to chat screen works',
      },
      {
        step: 2,
        instruction: 'Verify loading state',
        detailedSteps: [
          '1. Observe the screen after navigation',
          '2. Check for loading indicator',
        ],
        whatYouShouldSee: 'A loading spinner (BeeLoaderWidget) appears in the center of the screen. This indicates that the chat URL is being fetched from the API. Loading state is shown while API request is in progress.',
        expectedResult: 'Loading state is displayed',
      },
      {
        step: 3,
        instruction: 'Verify chat interface loads',
        detailedSteps: [
          '1. Wait for loading to complete',
          '2. Check if chat interface appears',
        ],
        whatYouShouldSee: 'After loading completes, a web view (InAppWebView) appears filling the screen below the app bar. The web view displays the chat interface from the fetched URL. You can see the chat interface with message history, input field, and send button.',
        expectedResult: 'Chat interface loads successfully',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'User is logged in',
      'Network connection is available',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Chat URL is fetched from API using MyOrdersService.fetchChatUrl',
    successChecklist: [
      '✓ Navigation works',
      '✓ Loading state appears',
      '✓ Chat interface loads',
      '✓ Web view displays correctly',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-003',
    title: 'Display Unread Message Count Badge',
    whatYoureTesting: 'Verify that badge showing unread message count appears on live chat button when there are unread messages',
    whyItMatters: 'Users need to know if they have unread messages. Badge helps them stay informed.',
    estimatedTime: '1-2 minutes',
    type: 'Functional',
    priority: 'P1',
    relatedUseCases: ['UC-LIVE-CHAT-002'],
    relatedEdgeCases: ['EC-LIVE-CHAT-004'],
    testSteps: [
      {
        step: 1,
        instruction: 'Check live chat button with unread messages',
        detailedSteps: [
          '1. Ensure you have unread messages in chat',
          '2. Navigate to screen with live chat button',
          '3. Observe the button',
        ],
        whatYouShouldSee: 'A red badge appears on the top-right corner of the live chat button. The badge is circular with white text showing the number of unread messages (e.g., "3" if there are 3 unread messages). Badge is positioned outside the button circle.',
        expectedResult: 'Badge is displayed',
      },
      {
        step: 2,
        instruction: 'Verify badge updates',
        detailedSteps: [
          '1. Open chat and read messages',
          '2. Return to previous screen',
          '3. Check badge again',
        ],
        whatYouShouldSee: 'After reading messages, the badge updates. If all messages are read (unread count becomes 0), the badge disappears. If there are still unread messages, badge shows updated count.',
        expectedResult: 'Badge updates correctly',
      },
      {
        step: 3,
        instruction: 'Verify badge when no unread messages',
        detailedSteps: [
          '1. Ensure no unread messages',
          '2. Check live chat button',
        ],
        whatYouShouldSee: 'When unread count is 0, no badge appears on the button. The button displays normally without any badge indicator.',
        expectedResult: 'Badge is hidden when count is 0',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'Live chat button is visible',
      'User has chat history',
    ],
    testData: 'Unread message count from API',
    automatable: true,
    status: 'Not Started',
    notes: 'Badge visibility is controlled by messagesCount > 0. Badge uses Observer to reactively update when count changes.',
    successChecklist: [
      '✓ Badge appears when unread count > 0',
      '✓ Badge shows correct count',
      '✓ Badge updates reactively',
      '✓ Badge hides when count is 0',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-004',
    title: 'Open Chat with Order Context (billId)',
    whatYoureTesting: 'Verify that live chat can be opened with order context by passing billId parameter',
    whyItMatters: 'Users need to get support for specific orders. Order context helps support agents assist better.',
    estimatedTime: '2 minutes',
    type: 'Functional',
    priority: 'P1',
    relatedUseCases: ['UC-LIVE-CHAT-003'],
    relatedEdgeCases: [],
    testSteps: [
      {
        step: 1,
        instruction: 'Open chat from order details',
        detailedSteps: [
          '1. Navigate to order details screen',
          '2. Find live chat button (if available)',
          '3. Tap the button',
        ],
        whatYouShouldSee: 'Live chat button may appear on order details screen. When you tap it, billId parameter is passed to the chat screen. Navigation occurs with order context.',
        expectedResult: 'Chat opens with billId',
      },
      {
        step: 2,
        instruction: 'Verify order context in chat',
        detailedSteps: [
          '1. Wait for chat to load',
          '2. Check chat interface',
        ],
        whatYouShouldSee: 'Chat interface loads. The chat URL may include order information or the support agent may see order context. Order details are available in the chat session.',
        expectedResult: 'Order context is available',
      },
    ],
    preconditions: [
      'User is viewing order details',
      'Order has billId',
      'Live chat is enabled',
    ],
    testData: 'billId from order',
    automatable: false,
    status: 'Not Started',
    notes: 'billId is passed as navigation data and used when fetching chat URL',
    successChecklist: [
      '✓ Chat opens with billId',
      '✓ Order context is passed',
      '✓ Chat interface loads',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-005',
    title: 'Interact with Chat Web View',
    whatYoureTesting: 'Verify that users can interact with the chat web view to send and receive messages',
    whyItMatters: 'Users need to communicate with support. Chat interface must be fully functional.',
    estimatedTime: '3-5 minutes',
    type: 'Functional',
    priority: 'P0',
    relatedUseCases: ['UC-LIVE-CHAT-004'],
    relatedEdgeCases: ['EC-LIVE-CHAT-005', 'EC-LIVE-CHAT-006'],
    testSteps: [
      {
        step: 1,
        instruction: 'Verify chat interface is loaded',
        detailedSteps: [
          '1. Open live chat',
          '2. Wait for web view to load',
          '3. Check chat interface',
        ],
        whatYouShouldSee: 'Web view displays the chat interface. You can see message history, input field, send button, and other chat controls. Interface is fully interactive.',
        expectedResult: 'Chat interface is displayed',
      },
      {
        step: 2,
        instruction: 'Send a message',
        detailedSteps: [
          '1. Type a message in the input field',
          '2. Tap send button',
        ],
        whatYouShouldSee: 'Message is typed in the input field. When you tap send, message appears in the chat. Message is sent to support agent. You can see your message in the chat history.',
        expectedResult: 'Message is sent successfully',
      },
      {
        step: 3,
        instruction: 'Receive a message',
        detailedSteps: [
          '1. Wait for response',
          '2. Check for new messages',
        ],
        whatYouShouldSee: 'When support agent responds, new message appears in chat. Message is displayed in the chat history. You can see agent\'s response.',
        expectedResult: 'Messages are received',
      },
    ],
    preconditions: [
      'Live chat screen is open',
      'Chat URL is loaded',
      'Network connection is available',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Chat functionality depends on the web view and external chat service',
    successChecklist: [
      '✓ Chat interface is interactive',
      '✓ Messages can be sent',
      '✓ Messages can be received',
      '✓ Chat history displays correctly',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-006',
    title: 'Navigate Back from Chat Screen',
    whatYoureTesting: 'Verify that users can navigate back from chat screen to previous screen',
    whyItMatters: 'Users need to return to previous screen after chat. Navigation must work correctly.',
    estimatedTime: '30 seconds',
    type: 'Functional',
    priority: 'P1',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: [],
    testSteps: [
      {
        step: 1,
        instruction: 'Navigate back from chat',
        detailedSteps: [
          '1. Open live chat',
          '2. Tap back button in app bar',
        ],
        whatYouShouldSee: 'When you tap the back button (arrow icon) in the app bar, navigation occurs. You return to the previous screen. Chat session may remain active in background.',
        expectedResult: 'Navigation back works',
      },
      {
        step: 2,
        instruction: 'Verify previous screen loads',
        detailedSteps: [
          '1. Check if previous screen appears',
          '2. Verify screen state',
        ],
        whatYouShouldSee: 'Previous screen loads correctly. Screen state is preserved. Live chat button is still visible if applicable.',
        expectedResult: 'Previous screen loads correctly',
      },
    ],
    preconditions: [
      'Live chat screen is open',
      'User navigated from another screen',
    ],
    testData: 'N/A',
    automatable: true,
    status: 'Not Started',
    notes: 'Back navigation uses standard Flutter navigation',
    successChecklist: [
      '✓ Back button works',
      '✓ Previous screen loads',
      '✓ Screen state is preserved',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-007',
    title: 'Handle Chat Loading State',
    whatYoureTesting: 'Verify that loading indicator is displayed while chat URL is being fetched',
    whyItMatters: 'Users need feedback that chat is loading. Loading state prevents confusion.',
    estimatedTime: '1-2 minutes',
    type: 'Functional',
    priority: 'P0',
    relatedUseCases: ['UC-LIVE-CHAT-005'],
    relatedEdgeCases: ['EC-LIVE-CHAT-002', 'EC-LIVE-CHAT-007'],
    testSteps: [
      {
        step: 1,
        instruction: 'Open live chat',
        detailedSteps: [
          '1. Tap live chat button',
          '2. Observe screen immediately',
        ],
        whatYouShouldSee: 'Chat screen appears with app bar showing "Contact Us" title. In the body area, a loading spinner (BeeLoaderWidget) appears centered on the screen. Loading indicator shows that chat URL is being fetched.',
        expectedResult: 'Loading state is displayed',
      },
      {
        step: 2,
        instruction: 'Wait for loading to complete',
        detailedSteps: [
          '1. Observe loading indicator',
          '2. Wait for API response',
        ],
        whatYouShouldSee: 'Loading spinner continues to animate while API request is in progress. Once API responds with chat URL, loading stops and chat interface appears.',
        expectedResult: 'Loading completes',
      },
      {
        step: 3,
        instruction: 'Verify transition to chat',
        detailedSteps: [
          '1. Check if loading disappears',
          '2. Verify chat appears',
        ],
        whatYouShouldSee: 'Loading spinner disappears smoothly. Web view fades in showing the chat interface. Transition is smooth without flickering.',
        expectedResult: 'Transition to chat is smooth',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'User is logged in',
      'Network connection is available',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Loading state is controlled by isLoading observable in ViewModel',
    successChecklist: [
      '✓ Loading indicator appears',
      '✓ Loading shows during API call',
      '✓ Loading disappears when complete',
      '✓ Transition is smooth',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-008',
    title: 'Handle Chat URL Fetch Error',
    whatYoureTesting: 'Verify that error state is displayed when chat URL cannot be fetched',
    whyItMatters: 'Users need to know when chat fails to load. Error handling prevents confusion.',
    estimatedTime: '2 minutes',
    type: 'Functional',
    priority: 'P0',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: ['EC-LIVE-CHAT-002', 'EC-LIVE-CHAT-008'],
    testSteps: [
      {
        step: 1,
        instruction: 'Simulate API error',
        detailedSteps: [
          '1. Disable network or simulate API failure',
          '2. Tap live chat button',
        ],
        whatYouShouldSee: 'Chat screen appears. Loading indicator appears briefly. Then error state is displayed.',
        expectedResult: 'Error state appears',
      },
      {
        step: 2,
        instruction: 'Verify error display',
        detailedSteps: [
          '1. Check error message',
          '2. Check error icon',
        ],
        whatYouShouldSee: 'Error widget (CustomErrorWidget) appears centered on screen. A sad mascot image (mascotSadColored) is displayed at 125x125 size. Below the image, error text "Something went wrong" (localized) is shown. Error is clearly visible.',
        expectedResult: 'Error is displayed correctly',
      },
      {
        step: 3,
        instruction: 'Retry after fixing error',
        detailedSteps: [
          '1. Enable network',
          '2. Navigate back and reopen chat',
        ],
        whatYouShouldSee: 'After fixing the issue and reopening chat, loading appears again. Chat URL is fetched successfully and chat interface loads.',
        expectedResult: 'Retry works correctly',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'Network can be disabled or API can fail',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Error occurs when chat URL is null after API call fails',
    successChecklist: [
      '✓ Error state appears',
      '✓ Error message is clear',
      '✓ Error icon is displayed',
      '✓ Retry works',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-009',
    title: 'Chat Button Animation Behavior',
    whatYoureTesting: 'Verify that live chat button animation works correctly and continuously',
    whyItMatters: 'Animation draws attention to chat button. Smooth animation improves user experience.',
    estimatedTime: '1 minute',
    type: 'UI',
    priority: 'P2',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: [],
    testSteps: [
      {
        step: 1,
        instruction: 'Observe button animation',
        detailedSteps: [
          '1. Navigate to screen with live chat button',
          '2. Watch the button',
        ],
        whatYouShouldSee: 'Live chat button continuously animates with a bounce effect. Button moves vertically up and down. Animation uses CurvedAnimation with easeIn curve. Animation repeats infinitely with 1-second duration per cycle.',
        expectedResult: 'Animation works continuously',
      },
      {
        step: 2,
        instruction: 'Verify animation smoothness',
        detailedSteps: [
          '1. Observe animation for 10 seconds',
          '2. Check for stuttering or glitches',
        ],
        whatYouShouldSee: 'Animation is smooth without stuttering or glitches. Movement is fluid and consistent. Animation does not affect button tapability.',
        expectedResult: 'Animation is smooth',
      },
      {
        step: 3,
        instruction: 'Verify animation stops on dispose',
        detailedSteps: [
          '1. Navigate away from screen',
          '2. Check if animation stops',
        ],
        whatYouShouldSee: 'When you navigate away, animation controller is disposed. Animation stops properly without memory leaks.',
        expectedResult: 'Animation disposes correctly',
      },
    ],
    preconditions: [
      'Live chat button is visible',
      'Screen with button is displayed',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Animation uses AnimationController with SingleTickerProviderStateMixin',
    successChecklist: [
      '✓ Animation works continuously',
      '✓ Animation is smooth',
      '✓ Animation disposes correctly',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-010',
    title: 'Tutorial Support for Live Chat Button',
    whatYoureTesting: 'Verify that tutorial can be displayed for live chat button when configured',
    whyItMatters: 'Tutorials help users discover features. Tutorial support enables onboarding.',
    estimatedTime: '2 minutes',
    type: 'Functional',
    priority: 'P2',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: [],
    testSteps: [
      {
        step: 1,
        instruction: 'Configure tutorial for live chat',
        detailedSteps: [
          '1. Set up tutorial configuration',
          '2. Enable tutorial for live chat button',
        ],
        whatYouShouldSee: 'Tutorial is configured to highlight live chat button. Tutorial key is passed to LiveChatButton widget.',
        expectedResult: 'Tutorial is configured',
      },
      {
        step: 2,
        instruction: 'Verify tutorial display',
        detailedSteps: [
          '1. Navigate to screen with live chat',
          '2. Check if tutorial appears',
        ],
        whatYouShouldSee: 'If tutorial is enabled, tutorial overlay appears highlighting the live chat button. Tutorial can be dismissed. Tutorial helps users discover chat feature.',
        expectedResult: 'Tutorial displays if configured',
      },
    ],
    preconditions: [
      'Live chat button is visible',
      'Tutorial is configured',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Tutorial support is provided via hasTutorial and tutoiralKey parameters',
    successChecklist: [
      '✓ Tutorial can be configured',
      '✓ Tutorial displays if enabled',
      '✓ Tutorial highlights button correctly',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-011',
    title: 'Web View Cache and Cookie Handling',
    whatYoureTesting: 'Verify that web view cache and cookies are cleared when chat loads',
    whyItMatters: 'Cache clearing ensures fresh chat session. Cookie handling prevents authentication issues.',
    estimatedTime: '2 minutes',
    type: 'Functional',
    priority: 'P1',
    relatedUseCases: ['UC-LIVE-CHAT-004'],
    relatedEdgeCases: ['EC-LIVE-CHAT-009'],
    testSteps: [
      {
        step: 1,
        instruction: 'Open live chat',
        detailedSteps: [
          '1. Tap live chat button',
          '2. Wait for chat to load',
        ],
        whatYouShouldSee: 'Chat screen loads. Web view initializes. Cache and cookies are cleared automatically when web view loads.',
        expectedResult: 'Cache and cookies are cleared',
      },
      {
        step: 2,
        instruction: 'Verify fresh session',
        detailedSteps: [
          '1. Check chat interface',
          '2. Verify authentication',
        ],
        whatYouShouldSee: 'Chat interface loads with fresh session. Authentication works correctly. No cached data interferes with chat.',
        expectedResult: 'Fresh session is established',
      },
    ],
    preconditions: [
      'Live chat is enabled',
      'User is logged in',
    ],
    testData: 'N/A',
    automatable: false,
    status: 'Not Started',
    notes: 'Cache and cookies are cleared in onReceivedServerTrustAuthRequest callback',
    successChecklist: [
      '✓ Cache is cleared',
      '✓ Cookies are cleared',
      '✓ Fresh session is established',
    ],
  },
  {
    id: 'TC-LIVE-CHAT-012',
    title: 'Live Chat Button Visibility Based on Settings',
    whatYoureTesting: 'Verify that live chat button only appears when live chat is enabled in settings',
    whyItMatters: 'Button should only appear when feature is available. Conditional display prevents confusion.',
    estimatedTime: '1 minute',
    type: 'Functional',
    priority: 'P1',
    relatedUseCases: ['UC-LIVE-CHAT-001'],
    relatedEdgeCases: ['EC-LIVE-CHAT-001'],
    testSteps: [
      {
        step: 1,
        instruction: 'Check button when live chat is enabled',
        detailedSteps: [
          '1. Ensure live chat is enabled in settings',
          '2. Navigate to profile screen',
        ],
        whatYouShouldSee: 'Live chat button appears as floating action button on profile screen (or other configured screens). Button is visible and functional.',
        expectedResult: 'Button appears when enabled',
      },
      {
        step: 2,
        instruction: 'Check button when live chat is disabled',
        detailedSteps: [
          '1. Disable live chat in settings',
          '2. Navigate to profile screen',
        ],
        whatYouShouldSee: 'Live chat button does not appear. Button is hidden when feature is disabled. Screen displays normally without chat button.',
        expectedResult: 'Button is hidden when disabled',
      },
    ],
    preconditions: [
      'Settings can be configured',
      'User can navigate to screens with chat button',
    ],
    testData: 'N/A',
    automatable: true,
    status: 'Not Started',
    notes: 'Button visibility is controlled by isLiveChatEnabled setting',
    successChecklist: [
      '✓ Button appears when enabled',
      '✓ Button is hidden when disabled',
    ],
  },
];

